<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>A Dinâmica dos Líquidos Corporais: Uma Análise Interativa</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700;800&display=swap" rel="stylesheet">
    <style>
        :root {
            /* == Theme Colors for Body Fluids == */
            --extracelular-color: #3b82f6;  /* Vibrant Blue for Extracellular */
            --intracelular-color: #f43f5e;  /* Vibrant Rose for Intracellular */
            --equilibrio-color: #84cc16;    /* Vibrant Lime for Balance/General */

            /* Glow/Highlight Colors for light theme */
            --extracelular-glow: rgba(59, 130, 246, 0.2);
            --intracelular-glow: rgba(244, 63, 94, 0.2);
            --equilibrio-glow: rgba(132, 204, 22, 0.2);
            
            /* Theme Border Colors for light theme */
            --extracelular-border: rgba(59, 130, 246, 0.4);
            --intracelular-border: rgba(244, 63, 94, 0.4);
            --equilibrio-border: rgba(132, 204, 22, 0.4);

            /* Light Theme Palette */
            --bg-main: #f8fafc;
            --text-primary: #1e293b;
            --text-secondary: #475569;
        }

        html { scroll-behavior: smooth; }
        body { 
            font-family: 'Inter', sans-serif; 
            color: var(--text-primary);
            overflow-x: hidden;
            background-color: var(--bg-main);
            transition: background-color 0.5s ease-in-out; /* For quiz feedback */
        }
        
        /* == Background color flash for Quiz == */
        body.correct-bg { background-color: #dcfce7; }
        body.incorrect-bg { background-color: #fee2e2; }

        /* Animated background shapes */
        .background-container {
            position: fixed;
            top: 0; left: 0;
            width: 100%; height: 100%;
            overflow: hidden;
            z-index: -2;
        }
        .light-bubble {
            position: absolute;
            border-radius: 50%;
            filter: blur(140px);
            opacity: 0.15; 
            animation: moveBubble 35s infinite alternate;
        }
        .light-bubble.b1 { width: 45vw; height: 45vw; top: 5%; left: -10%; background: var(--extracelular-color); animation-duration: 40s; }
        .light-bubble.b2 { width: 45vw; height: 45vw; top: 40%; left: 70%; background: var(--intracelular-color); animation-duration: 35s; }
        .light-bubble.b3 { width: 50vw; height: 50vw; top: 60%; left: 10%; background: var(--equilibrio-color); animation-duration: 45s; }

        @keyframes moveBubble {
            0% { transform: translate(0, 0) scale(1); }
            100% { transform: translate(15vw, -20vh) scale(1.2); }
        }
        
        /* Dynamic background glows for transitions */
        .dynamic-bg-glow {
            position: fixed;
            top: 50%;
            left: 50%;
            width: 150vmax;
            height: 150vmax;
            transform: translate(-50%, -50%);
            border-radius: 50%;
            filter: blur(120px);
            opacity: 0;
            transition: opacity 1.5s ease-in-out;
            z-index: -1;
        }
        #bg-fundamentos { background-color: var(--equilibrio-color); }
        #bg-trocas { background-color: var(--extracelular-color); }
        #bg-desequilibrios { background-color: var(--intracelular-color); }

        .section-container {
            width: 100%;
            padding: 7rem 2rem;
            display: flex;
            justify-content: center;
            align-items: center;
            flex-direction: column;
            position: relative;
            z-index: 1;
        }
        
        #hero { 
            min-height: 90vh; 
            padding-top: 2rem; 
            padding-bottom: 2rem;
        }
        #hero h1 { 
            font-size: clamp(2.8rem, 7vw, 5rem); 
            font-weight: 800; 
            letter-spacing: -0.05em; 
            text-shadow: 0 0 20px rgba(0,0,0,0.05);
        }
        #hero p { 
            font-size: clamp(1.1rem, 2.5vw, 1.35rem); 
            max-width: 650px; 
            color: var(--text-secondary);
            margin-left: auto;
            margin-right: auto;
        }

        .section-header-card {
            position: relative;
            background: rgba(255, 255, 255, 0.35);
            backdrop-filter: blur(20px);
            -webkit-backdrop-filter: blur(20px);
            border: 1px solid rgba(255, 255, 255, 0.2);
            border-radius: 1.5rem;
            padding: 2.5rem;
            margin-bottom: 3rem;
            box-shadow: 0 8px 32px 0 rgba(0, 0, 0, 0.1);
            text-align: center;
            max-width: 1200px;
            width: 100%;
            overflow: hidden;
            z-index: 2;
            opacity: 0;
            transform: translateY(50px);
            transition: opacity 0.5s ease-out, transform 0.5s cubic-bezier(0.25, 0.46, 0.45, 0.94);
        }
        .section-header-card.visible {
            opacity: 1;
            transform: translateY(0);
        }
        .section-header-card::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            border-radius: inherit;
            pointer-events: none;
            box-shadow: inset 0 0 0 1.5px rgba(255, 255, 255, 0.6);
            z-index: 1;
        }
        .section-header-card > * {
             position: relative;
             z-index: 2;
        }
        .section-header-card .section-title {
            margin-bottom: 1rem;
        }
        #hero .section-header-card { margin-bottom: 0; } 

        .section-title { font-size: clamp(2.2rem, 5.5vw, 4rem); font-weight: 800; letter-spacing: -0.04em; color: var(--text-primary); position: relative; }
        .section-subtitle { 
            font-size: clamp(1rem, 2vw, 1.2rem); 
            max-width: 700px; 
            color: var(--text-secondary); 
            margin-bottom: 0;
            margin-left: auto; 
            margin-right: auto; 
        }

        .topics-grid {
            width: 100%;
            max-width: 1200px;
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(320px, 1fr));
            gap: 1.5rem;
            align-items: start;
        }

        .topic-card {
            position: relative;
            background: rgba(255, 255, 255, 0.35);
            backdrop-filter: blur(20px);
            -webkit-backdrop-filter: blur(20px);
            border: 1px solid rgba(255, 255, 255, 0.2);
            border-radius: 1.5rem;
            transition: all 0.5s cubic-bezier(0.25, 0.46, 0.45, 0.94);
            box-shadow: 0 8px 32px 0 rgba(0, 0, 0, 0.1);
            overflow: hidden;
            opacity: 0;
            transform: translateY(50px);
            transition: opacity 0.5s ease-out, transform 0.5s cubic-bezier(0.25, 0.46, 0.45, 0.94);
        }
        
        .topic-card.visible {
            opacity: 1;
            transform: translateY(0);
        }
        
        .topic-card:nth-child(1) { transition-delay: 0.05s; }
        .topic-card:nth-child(2) { transition-delay: 0.1s; }
        .topic-card:nth-child(3) { transition-delay: 0.15s; }
        .topic-card:nth-child(4) { transition-delay: 0.2s; }
        .topic-card:nth-child(5) { transition-delay: 0.25s; }


        .topic-card::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            border-radius: inherit;
            pointer-events: none;
            box-shadow: inset 0 0 0 1.5px rgba(255, 255, 255, 0.6);
            transition: box-shadow 0.4s ease;
            z-index: 1;
        }
        
        .topic-card:hover::before { 
            box-shadow: inset 0 0 0 2px rgba(255, 255, 255, 0.8);
        }
        
        .topic-card > div {
            position: relative;
            z-index: 2;
        }

        .topic-card:hover { 
            transform: translateY(-5px);
            border-color: rgba(255, 255, 255, 0.3); 
        }
        
        .topic-card .summary { 
            color: var(--text-primary);
            text-shadow: none;
            font-size: 1.125rem; 
            font-weight: 600; 
            padding: 1.5rem; 
            cursor: pointer; 
            outline: none; 
            display: flex; 
            justify-content: space-between; 
            align-items: center; 
        }
        .topic-card .summary::after { 
            content: '+'; 
            font-size: 1.5rem; 
            font-weight: 400; 
            color: var(--text-secondary);
            text-shadow: none;
            transition: transform 0.3s ease-in-out; 
        }
        .topic-card.is-open > .summary::after { transform: rotate(45deg); }
        .topic-card.is-open > .summary { 
            border-bottom: 1px solid rgba(255, 255, 255, 0.2); 
        }
        
        .topic-content-wrapper {
            max-height: 0;
            overflow: hidden;
            transition: max-height 0.5s ease-in-out;
        }
        .topic-content { 
            padding: 1.5rem; 
            font-size: 0.95rem; 
            color: var(--text-secondary);
            text-shadow: none;
        }

        .image-bubble {
            position: relative;
            background: rgba(255, 255, 255, 0.2);
            border-radius: 1.25rem;
            padding: 0.75rem;
            margin-top: 1rem;
            backdrop-filter: blur(10px);
            -webkit-backdrop-filter: blur(10px);
            cursor: pointer;
            transition: all 0.3s ease;
            box-shadow: 0 4px 15px rgba(0,0,0,0.05);
        }
        .image-bubble:hover {
            transform: scale(1.03);
            box-shadow: 0 6px 20px rgba(0,0,0,0.1);
        }
        .image-bubble svg {
            width: 100%;
            height: auto;
            border-radius: 0.75rem;
            display: block;
        }
        
        #fundamentos .topic-card.is-open {
            box-shadow: 0 8px 25px rgba(0,0,0,0.08), inset 0 0 0 2px var(--equilibrio-border);
        }
        #trocas .topic-card.is-open {
            box-shadow: 0 8px 25px rgba(0,0,0,0.08), inset 0 0 0 2px var(--extracelular-border);
        }
        #desequilibrios .topic-card.is-open {
            box-shadow: 0 8px 25px rgba(0,0,0,0.08), inset 0 0 0 2px var(--intracelular-border);
        }
        
        #fundamentos .topic-card.is-open:hover {
            box-shadow: 0 8px 25px rgba(0,0,0,0.1), inset 0 0 0 2px rgba(132, 204, 22, 0.6);
        }
        #trocas .topic-card.is-open:hover {
            box-shadow: 0 8px 25px rgba(0,0,0,0.1), inset 0 0 0 2px rgba(59, 130, 246, 0.6);
        }
        #desequilibrios .topic-card.is-open:hover {
            box-shadow: 0 8px 25px rgba(0,0,0,0.1), inset 0 0 0 2px rgba(244, 63, 94, 0.6);
        }
        
        .term { 
            text-decoration: none; 
            cursor: pointer; 
            font-weight: 500;
            padding: 4px 10px;
            border-radius: 0.6rem;
            transition: all 0.2s ease-in-out;
            text-shadow: none;
        }
        #fundamentos .term { background-color: var(--equilibrio-glow); color: #4d7c0f; }
        #trocas .term { background-color: var(--extracelular-glow); color: #1d4ed8; }
        #desequilibrios .term { background-color: var(--intracelular-glow); color: #9d174d; }
        .term:hover { 
            filter: brightness(1.15); 
        }

        /* Modal Styling */
        #modal-overlay {
            position: fixed;
            top: 0; left: 0;
            width: 100%; height: 100%;
            background-color: rgba(248, 250, 252, 0.5);
            backdrop-filter: blur(8px);
            -webkit-backdrop-filter: blur(8px);
            display: flex;
            justify-content: center;
            align-items: center;
            padding: 1rem;
            opacity: 0;
            visibility: hidden;
            transition: opacity 0.4s ease, visibility 0s linear 0.4s;
            z-index: 1000;
        }
        #modal-overlay.visible {
            opacity: 1;
            visibility: visible;
            transition: opacity 0.4s ease;
        }
        
        #modal-content {
            background: rgba(255, 255, 255, 0.55); 
            backdrop-filter: blur(20px);
            -webkit-backdrop-filter: blur(20px);
            border: 1px solid rgba(255, 255, 255, 0.3);
            color: var(--text-primary);
            box-shadow: 0 25px 50px -12px rgba(0,0,0,0.15);
            border-radius: 2rem;
            position: relative;
            width: 90%;
            max-width: 500px;
            transform: scale(0.95);
            transition: transform 0.4s ease;
            overflow: hidden; 
        }
        
        #modal-content.image-modal {
             max-width: 650px;
        }
        
        #modal-content::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            border-radius: inherit;
            pointer-events: none;
            box-shadow: inset 0 0 0 1.5px rgba(255, 255, 255, 0.6);
            z-index: 1;
        }

        #modal-overlay.visible #modal-content { 
            transform: scale(1);
        }
        
        #modal-content.theme-fundamentos { box-shadow: 0 25px 50px -12px rgba(0,0,0,0.15), inset 0 0 0 2px var(--equilibrio-border); }
        #modal-content.theme-trocas { box-shadow: 0 25px 50px -12px rgba(0,0,0,0.15), inset 0 0 0 2px var(--extracelular-border); }
        #modal-content.theme-desequilibrios { box-shadow: 0 25px 50px -12px rgba(0,0,0,0.15), inset 0 0 0 2px var(--intracelular-border); }
        
        #modal-header, #modal-description {
            position: relative;
            z-index: 2;
        }

        #modal-header {
            border-bottom: 1px solid rgba(255, 255, 255, 0.2);
            background: transparent;
            text-align: center;
            padding: 1.5rem 3.5rem;
        }
        
        #modal-title { 
            font-size: 1.75rem; 
            font-weight: 700; 
            text-shadow: none;
        }
        #modal-header.theme-fundamentos #modal-title { color: var(--equilibrio-color); }
        #modal-header.theme-trocas #modal-title { color: var(--extracelular-color); }
        #modal-header.theme-desequilibrios #modal-title { color: var(--intracelular-color); }
        
        #modal-description { font-size: 1.05rem; color: var(--text-secondary); line-height: 1.7; padding: 1.5rem 2rem 2rem 2rem; }
        
        #modal-image-container {
            padding: 1.5rem;
            display: flex;
            justify-content: center;
        }
        #modal-image-container svg {
            width: 100%;
            max-width: 450px;
            height: auto;
            border-radius: 1rem;
        }

        #modal-close-btn {
            position: absolute;
            top: 1rem; right: 1rem;
            background: rgba(0,0,0,0.05);
            border: none;
            border-radius: 50%;
            width: 2.5rem; height: 2.5rem;
            cursor: pointer; 
            transition: background-color 0.2s ease, transform 0.2s ease;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.2rem;
            color: var(--text-secondary);
            z-index: 3;
        }
        #modal-close-btn:hover { background: rgba(0,0,0,0.1); transform: scale(1.1); }
        
        .footer-signature { text-align: center; padding: 4rem 1rem; background-color: transparent; color: #94a3b8; }
        ul { list-style-position: inside; padding-left: 0.5rem;}
        li { margin-bottom: 0.5rem; }

        /* == Quiz Styles == */
        #quiz-section {
             background: rgba(255, 255, 255, 0.2);
             backdrop-filter: blur(15px);
             -webkit-backdrop-filter: blur(15px);
             border-top: 1px solid rgba(255, 255, 255, 0.3);
             padding-bottom: 4rem;
        }

        .quiz-container {
            max-width: 800px;
            width: 100%;
            background: rgba(255, 255, 255, 0.5);
            border: 1px solid rgba(255, 255, 255, 0.2);
            border-radius: 2rem;
            padding: 2.5rem;
            box-shadow: 0 10px 40px rgba(0,0,0,0.1);
            position: relative;
        }
        
        #quiz-timer {
            position: absolute;
            top: -20px;
            right: 20px;
            background: rgba(255, 255, 255, 0.4);
            backdrop-filter: blur(10px);
            -webkit-backdrop-filter: blur(10px);
            color: var(--text-primary);
            width: 60px;
            height: 60px;
            border-radius: 50%;
            display: flex;
            justify-content: center;
            align-items: center;
            font-size: 1.5rem;
            font-weight: 700;
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.1);
            border: 1px solid rgba(255, 255, 255, 0.5);
        }

        #modal-description { font-size: 1.05rem; color: var(--text-secondary); line-height: 1.7; padding: 0 2rem 2rem 2rem; }
        
        #quiz-question {
            font-size: 1.5rem;
            font-weight: 600;
            color: var(--text-primary);
            margin-bottom: 2rem;
        }

        #quiz-options {
            list-style: none;
            padding: 0;
            display: flex;
            flex-direction: column;
            gap: 1rem;
        }

        .quiz-option {
            background-color: rgba(255,255,255,0.7);
            border: 1px solid rgba(0,0,0,0.05);
            border-radius: 1rem;
            padding: 1.25rem;
            font-size: 1.1rem;
            cursor: pointer;
            transition: transform 0.2s ease-out, box-shadow 0.2s ease-out, background-color 0.2s ease-out;
            box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.07), 0 2px 4px -2px rgba(0, 0, 0, 0.07);
            will-change: transform, box-shadow;
        }

        .quiz-option:hover {
            transform: translateY(-3px);
            background-color: white;
            box-shadow: 0 10px 15px -3px rgba(0, 0, 0, 0.1), 0 4px 6px -4px rgba(0, 0, 0, 0.1);
        }
        
        .quiz-option.disabled {
            cursor: not-allowed;
            opacity: 0.7;
        }
        
        .quiz-option.correct-answer {
            border-color: #22c55e;
            background-color: #f0fdf4;
            color: #15803d;
            font-weight: 600;
        }
        
        .quiz-option.incorrect-answer {
            border-color: #ef4444;
            background-color: #fef2f2;
            color: #b91c1c;
            font-weight: 600;
        }

        #quiz-start-btn, #restart-quiz-btn {
            background: rgba(255, 255, 255, 0.4);
            backdrop-filter: blur(10px);
            -webkit-backdrop-filter: blur(10px);
            font-weight: 700;
            padding: 1rem 2.5rem;
            border-radius: 1rem;
            font-size: 1.2rem;
            border: 1px solid rgba(255, 255, 255, 0.5);
            cursor: pointer;
            transition: all 0.2s ease-in-out;
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.1);
        }
        
        #quiz-start-btn {
            color: var(--text-primary);
        }
        #restart-quiz-btn {
            color: var(--extracelular-color);
             margin-top: 2rem;
        }

        #quiz-start-btn:hover, #restart-quiz-btn:hover {
            transform: scale(1.05);
            background: rgba(255, 255, 255, 0.6);
            box-shadow: 0 6px 20px rgba(0, 0, 0, 0.15);
        }
        
        #quiz-results {
             text-align: center;
        }
        
        #quiz-results h3 {
             font-size: 2rem;
             font-weight: 700;
             margin-bottom: 1.5rem;
        }

        #quiz-percentage {
            font-size: 3.5rem;
            font-weight: 800;
            color: var(--text-primary);
            margin-bottom: 2rem;
            width: 150px;
            height: 150px;
            background: rgba(255, 255, 255, 0.4);
            backdrop-filter: blur(10px);
            -webkit-backdrop-filter: blur(10px);
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            margin-left: auto;
            margin-right: auto;
            border: 1px solid rgba(255, 255, 255, 0.5);
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.1);
        }
        
        .results-stats {
            display: flex;
            justify-content: center;
            gap: 1.5rem;
            margin-bottom: 2.5rem;
            font-size: 1.1rem;
        }
        
        .stat-correct, .stat-incorrect {
            font-weight: 600;
            color: var(--text-primary);
            padding: 0.5rem 1.25rem;
            border-radius: 9999px;
            transition: all 0.2s ease-in-out;
        }

        .stat-correct {
            background-color: rgba(34, 197, 94, 0.25); 
        }

        .stat-incorrect {
            background-color: rgba(239, 68, 68, 0.25);
        }
        
        #missed-topics-list {
            display: flex;
            flex-wrap: wrap;
            justify-content: center;
            gap: 0.75rem;
            list-style: none;
            padding: 0;
            margin-top: 1rem;
        }

        .missed-topic-bubble {
            background-color: #f1f5f9;
            color: var(--text-secondary);
            padding: 0.5rem 1rem;
            border-radius: 9999px;
            font-size: 0.9rem;
            font-weight: 500;
            transition: all 0.2s ease-in-out;
            cursor: pointer;
            border: 2px solid transparent;
        }

        .missed-topic-bubble:hover {
            background-color: #e2e8f0;
            transform: translateY(-2px);
            box-shadow: 0 4px 10px rgba(0,0,0,0.05);
        }

        .missed-topic-bubble.visited-topic {
            border-color: #22c55e;
            background-color: #f0fdf4;
            color: #166534;
        }

    </style>
</head>
<body>
    <div class="background-container">
        <div class="light-bubble b1"></div>
        <div class="light-bubble b2"></div>
        <div class="light-bubble b3"></div>
        <div class="dynamic-bg-glow" id="bg-fundamentos"></div>
        <div class="dynamic-bg-glow" id="bg-trocas"></div>
        <div class="dynamic-bg-glow" id="bg-desequilibrios"></div>
    </div>

    <!-- Hero Section -->
    <section id="hero" class="section-container">
        <div class="section-header-card">
            <h1>A Dinâmica dos Líquidos Corporais</h1>
            <p class="mt-4">Uma exploração interativa dos compartimentos de líquidos do corpo, as forças que governam suas trocas e as consequências de seus desequilíbrios.</p>
        </div>
    </section>
    
    <!-- Fundamentals Section -->
    <section id="fundamentos" class="section-container">
        <div class="section-header-card">
            <h2 class="section-title">Fundamentos dos Compartimentos</h2>
            <p class="section-subtitle">Nosso corpo é um vasto oceano dividido em compartimentos. Entender o líquido intracelular e extracelular é a chave para a fisiologia e a homeostase.</p>
        </div>
        <div class="topics-grid">
            <div class="topic-card" id="topic-lic-e-lec">
                <div class="summary">Líquido Intracelular (LIC) vs. Extracelular (LEC)</div>
                <div class="topic-content-wrapper">
                    <div class="topic-content">
                        <ul>
                            <li>O corpo humano é composto por cerca de 60% de água, dividida em dois grandes compartimentos.</li>
                            <li><span class="term" data-description="É o líquido contido dentro das células. Corresponde a cerca de 2/3 (aprox. 28 litros) do total de água corporal e é rico em potássio (K+), magnésio (Mg++) e íons fosfato.">Líquido Intracelular (LIC)</span>: O oceano dentro das células.</li>
                            <li><span class="term" data-description="É todo o líquido fora das células. Corresponde a 1/3 (aprox. 14 litros) da água corporal e é rico em sódio (Na+), cloreto (Cl-) e bicarbonato (HCO3-).">Líquido Extracelular (LEC)</span>: O ambiente que banha as células.</li>
                             <li>O LEC é subdividido em <span class="term" data-description="O líquido que preenche os espaços entre as células (aprox. 11 litros).">líquido intersticial</span> e <span class="term" data-description="A parte líquida do sangue (aprox. 3 litros).">plasma sanguíneo</span>.</li>
                        </ul>
                    </div>
                </div>
            </div>
            <div class="topic-card" id="topic-composicao-ionica">
                <div class="summary">Composição Iônica</div>
                <div class="topic-content-wrapper">
                    <div class="topic-content">
                        <ul>
                            <li>A composição de íons é drasticamente diferente entre LIC e LEC, mantida por bombas iônicas como a Na+/K+ ATPase.</li>
                            <li>No <span class="term" data-description="Principal cátion é o Potássio (K+). Principais ânions são fosfatos e proteínas.">LIC</span>, predomina o K⁺.</li>
                            <li>No <span class="term" data-description="Principal cátion é o Sódio (Na+). Principais ânions são Cloreto (Cl-) e Bicarbonato (HCO3-).">LEC</span>, predomina o Na⁺.</li>
                            <li>As proteínas, por serem grandes e carregadas negativamente, são mais concentradas no plasma e no LIC, e influenciam a distribuição de outros íons pelo <span class="term" data-description="Um efeito que descreve a distribuição desigual de íons permeáveis através de uma membrana quando há um íon impermeável (como a proteína) de um lado. Isso faz com que a concentração de cátions seja ligeiramente maior no plasma do que no interstício.">Efeito Donnan</span>.</li>
                        </ul>
                        <div class="image-bubble" id="svg-composicao-ionica" data-img-svg="true" data-img-alt="Gráfico de Composição Iônica" data-img-description="Este gráfico compara as concentrações dos principais íons nos compartimentos extracelular (rosa e azul) e intracelular (laranja, amarelo, verde). Note a predominância de Sódio (Na+) no LEC e de Potássio (K+) no LIC, uma diferença crucial mantida ativamente pelas células.">
                            <svg viewBox="0 0 350 400" xmlns="http://www.w3.org/2000/svg" class="text-sm font-sans" fill="#475569">
                                <title>Gráfico de Composição Iônica LIC vs LEC</title>
                                <!-- Axes and Labels -->
                                <line x1="10" y1="200" x2="340" y2="200" stroke="#475569" stroke-width="1.5"></line>
                                <line x1="175" y1="10" x2="175" y2="390" stroke="#475569" stroke-width="1.5" stroke-dasharray="4"></line>
                                <g>
                                    <rect x="55" y="12" width="70" height="25" rx="5" fill="rgba(255,255,255,0.8)"></rect>
                                    <text x="90" y="28" text-anchor="middle" font-weight="600" fill="#1e293b">Cátions</text>
                                </g>
                                <g>
                                    <rect x="225" y="12" width="70" height="25" rx="5" fill="rgba(255,255,255,0.8)"></rect>
                                    <text x="260" y="28" text-anchor="middle" font-weight="600" fill="#1e293b">Ânions</text>
                                </g>
                                <text x="330" y="150" text-anchor="middle" writing-mode="vertical-rl" font-weight="600" fill="#1e293b">EXTRACELULAR</text>
                                <text x="330" y="290" text-anchor="middle" writing-mode="vertical-rl" font-weight="600" fill="#1e293b">INTRACELULAR</text>
                                <text x="15" y="55" text-anchor="end">150</text>
                                <text x="15" y="105" text-anchor="end">100</text>
                                <text x="15" y="155" text-anchor="end">50</text>
                                <text x="15" y="205" text-anchor="end">0</text>
                                <text x="15" y="255" text-anchor="end">50</text>
                                <text x="15" y="305" text-anchor="end">100</text>
                                <text x="15" y="355" text-anchor="end">150</text>
                                <text x="5" y="205" text-anchor="middle" writing-mode="vertical-rl" font-size="0.8em">mEq/l</text>
                                <!-- Extracellular Bars -->
                                <rect x="30" y="58" width="40" height="142" fill="#fca5a5" stroke="#ef4444" stroke-width="1"></rect>
                                <g>
                                    <rect x="35" y="182" width="30" height="18" rx="4" fill="rgba(255,255,255,0.85)"></rect>
                                    <text x="50" y="195" text-anchor="middle">Na⁺</text>
                                </g>
                                <rect x="120" y="188" width="20" height="12" fill="#f9a8d4" stroke="#f472b6" stroke-width="1"></rect>
                                <g>
                                    <rect x="110" y="171" width="40" height="18" rx="4" fill="rgba(255,255,255,0.85)"></rect>
                                    <text x="130" y="184" text-anchor="middle">Ca⁺⁺</text>
                                </g>
                                <rect x="190" y="88" width="40" height="112" fill="#bfdbfe" stroke="#60a5fa" stroke-width="1"></rect>
                                <g>
                                    <rect x="198" y="182" width="24" height="18" rx="4" fill="rgba(255,255,255,0.85)"></rect>
                                    <text x="210" y="195" text-anchor="middle">Cl⁻</text>
                                </g>
                                <rect x="240" y="167" width="30" height="33" fill="#fca5a5" stroke="#ef4444" stroke-width="1"></rect>
                                <g>
                                    <rect x="235" y="182" width="40" height="18" rx="4" fill="rgba(255,255,255,0.85)"></rect>
                                    <text x="255" y="195" text-anchor="middle">HCO₃⁻</text>
                                </g>
                                <rect x="280" y="180" width="30" height="20" fill="#bbf7d0" stroke="#4ade80" stroke-width="1"></rect>
                                <g>
                                    <rect x="265" y="162" width="60" height="18" rx="4" fill="rgba(255,255,255,0.85)"></rect>
                                    <text x="295" y="175" text-anchor="middle">Proteínas</text>
                                </g>
                                <!-- Intracellular Bars -->
                                <rect x="80" y="200" width="30" height="145" fill="#fde047" stroke="#facc15" stroke-width="1"></rect>
                                <g>
                                    <rect x="83" y="202" width="24" height="18" rx="4" fill="rgba(255,255,255,0.85)"></rect>
                                    <text x="95" y="215" text-anchor="middle">K⁺</text>
                                </g>
                                <rect x="120" y="200" width="20" height="30" fill="#99f6e4" stroke="#5eead4" stroke-width="1"></rect>
                                <g>
                                    <rect x="110" y="222" width="40" height="18" rx="4" fill="rgba(255,255,255,0.85)"></rect>
                                    <text x="130" y="235" text-anchor="middle">Mg⁺⁺</text>
                                </g>
                                <rect x="190" y="200" width="40" height="130" fill="#fef9c3" stroke="#fde047" stroke-width="1"></rect>
                                <g>
                                    <rect x="185" y="205" width="50" height="30" rx="5" fill="rgba(255,255,255,0.8)"></rect>
                                    <text x="210" y="218" text-anchor="middle" font-size="0.8em">PO₄⁻ e</text>
                                    <text x="210" y="229" text-anchor="middle" font-size="0.8em">ânions org.</text>
                                </g>
                                <rect x="280" y="200" width="30" height="55" fill="#bbf7d0" stroke="#4ade80" stroke-width="1"></rect>
                                <g>
                                    <rect x="265" y="247" width="60" height="18" rx="4" fill="rgba(255,255,255,0.85)"></rect>
                                    <text x="295" y="260" text-anchor="middle">Proteínas</text>
                                </g>
                            </svg>
                        </div>
                    </div>
                </div>
            </div>
            <div class="topic-card" id="topic-hematocrito">
                <div class="summary">Volume Sanguíneo e Hematócrito</div>
                <div class="topic-content-wrapper">
                    <div class="topic-content">
                        <ul>
                            <li>O sangue contém tanto LEC (plasma) quanto LIC (dentro das hemácias).</li>
                            <li><span class="term" data-description="É a fração do volume sanguíneo composta por hemácias (glóbulos vermelhos). É um indicador importante da viscosidade do sangue e da capacidade de transporte de oxigênio.">Hematócrito</span>: Percentual de hemácias no sangue.</li>
                            <li>Valores normais: Homens (40-45%), Mulheres (36-42%).</li>
                            <li>Na <span class="term" data-description="Condição de baixo hematócrito, que pode indicar sangramento, deficiências nutricionais ou outras doenças.">anemia grave</span>, o hematócrito pode cair para 10%. Na <span class="term" data-description="Condição de alto hematócrito, que aumenta a viscosidade do sangue e o risco de trombose.">policitemia</span>, pode chegar a 65%.</li>
                        </ul>
                    </div>
                </div>
            </div>
             <div class="topic-card" id="topic-balanco-de-massa">
                <div class="summary">A Lei do Balanço de Massa</div>
                <div class="topic-content-wrapper">
                    <div class="topic-content">
                        <ul>
                            <li>Este princípio fundamental afirma que a quantidade de uma substância no corpo permanece constante se a entrada for igual à saída.</li>
                            <li><span class="term" data-description="Inclui a ingestão de alimentos e líquidos, e a produção metabólica de água.">Ganhos</span>: O que entra no corpo.</li>
                            <li><span class="term" data-description="Inclui a excreção pelos rins (urina), pulmões (respiração), pele (suor) e fezes.">Perdas</span>: O que sai do corpo.</li>
                            <li>Se Ganhos > Perdas, ocorre acúmulo da substância.</li>
                            <li>Se Perdas > Ganhos, ocorre uma perda líquida da substância. Manter esse equilíbrio é essencial para a <span class="term" data-description="A tendência do corpo de manter um ambiente interno estável e relativamente constante.">homeostase</span>.</li>
                        </ul>
                    </div>
                </div>
            </div>
        </div>
    </section>

    <!-- Capillary Exchange Section -->
    <section id="trocas" class="section-container">
         <div class="section-header-card">
            <h2 class="section-title">A Troca nos Capilares</h2>
            <p class="section-subtitle">As fronteiras entre os compartimentos são dinâmicas. Nos capilares, um delicado balanço de forças determina o movimento de fluidos, essencial para nutrir os tecidos.</p>
        </div>
        <div class="topics-grid">
            <div class="topic-card" id="topic-forcas-de-starling">
                <div class="summary">As Forças de Starling</div>
                <div class="topic-content-wrapper">
                    <div class="topic-content">
                        <ul>
                            <li class="flex justify-between items-center bg-blue-50 p-2 rounded-lg mb-2">
                                <span><span class="term" data-description="A pressão exercida pelo sangue contra a parede do capilar. Tende a 'empurrar' o líquido para fora do capilar. (Pc)">Pressão Hidrostática Capilar (Pc)</span>: Força de saída.</span>
                                <span class="text-blue-600 font-bold flex items-center gap-1">Saída
                                    <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-arrow-up-right-circle" viewBox="0 0 16 16">
                                        <path fill-rule="evenodd" d="M1 8a7 7 0 1 0 14 0A7 7 0 0 0 1 8m15 0A8 8 0 1 1 0 8a8 8 0 0 1 16 0M5.854 10.854a.5.5 0 0 0 .708 0L12 5.707V8.5a.5.5 0 0 0 1 0v-4a.5.5 0 0 0-.5-.5H8.5a.5.5 0 0 0 0 1h2.793L5.146 10.146a.5.5 0 0 0 0 .708"/>
                                    </svg>
                                </span>
                            </li>
                            <li class="flex justify-between items-center bg-rose-50 p-2 rounded-lg mb-2">
                                <span><span class="term" data-description="A pressão do líquido no espaço intersticial. Tende a 'empurrar' o líquido para dentro do capilar. (Pi)">Pressão Hidrostática Intersticial (Pi)</span>: Força de entrada.</span>
                                <span class="text-rose-600 font-bold flex items-center gap-1">Entrada
                                    <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-arrow-down-left-circle" viewBox="0 0 16 16">
                                        <path fill-rule="evenodd" d="M1 8a7 7 0 1 0 14 0A7 7 0 0 0 1 8m15 0A8 8 0 1 1 0 8a8 8 0 0 1 16 0M10.854 5.146a.5.5 0 0 0 0 .708L5.707 11H8.5a.5.5 0 0 0 0-1H4.5a.5.5 0 0 0-.5.5v4a.5.5 0 0 0 1 0V8.207l5.146-5.147a.5.5 0 0 0 0-.708"/>
                                    </svg>
                                </span>
                            </li>
                            <li class="flex justify-between items-center bg-rose-50 p-2 rounded-lg mb-2">
                                <span><span class="term" data-description="A 'força osmótica' gerada pelas proteínas (principalmente albumina) no plasma. Tende a 'puxar' o líquido para dentro do capilar. (Πp)">Pressão Coloidosmótica Plasmática (Πp)</span>: Força de entrada.</span>
                                 <span class="text-rose-600 font-bold flex items-center gap-1">Entrada
                                    <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-arrow-down-left-circle" viewBox="0 0 16 16">
                                        <path fill-rule="evenodd" d="M1 8a7 7 0 1 0 14 0A7 7 0 0 0 1 8m15 0A8 8 0 1 1 0 8a8 8 0 0 1 16 0M10.854 5.146a.5.5 0 0 0 0 .708L5.707 11H8.5a.5.5 0 0 0 0-1H4.5a.5.5 0 0 0-.5.5v4a.5.5 0 0 0 1 0V8.207l5.146-5.147a.5.5 0 0 0 0-.708"/>
                                    </svg>
                                </span>
                            </li>
                            <li class="flex justify-between items-center bg-blue-50 p-2 rounded-lg">
                                <span><span class="term" data-description="A 'força osmótica' gerada por proteínas que escaparam para o interstício. Tende a 'puxar' o líquido para fora do capilar. (Πi)">Pressão Coloidosmótica Intersticial (Πi)</span>: Força de saída.</span>
                                 <span class="text-blue-600 font-bold flex items-center gap-1">Saída
                                    <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-arrow-up-right-circle" viewBox="0 0 16 16">
                                        <path fill-rule="evenodd" d="M1 8a7 7 0 1 0 14 0A7 7 0 0 0 1 8m15 0A8 8 0 1 1 0 8a8 8 0 0 1 16 0M5.854 10.854a.5.5 0 0 0 .708 0L12 5.707V8.5a.5.5 0 0 0 1 0v-4a.5.5 0 0 0-.5-.5H8.5a.5.5 0 0 0 0 1h2.793L5.146 10.146a.5.5 0 0 0 0 .708"/>
                                    </svg>
                                </span>
                            </li>
                        </ul>
                        <div class="image-bubble" id="svg-forcas-starling" data-img-svg="true" data-img-alt="Diagrama das Forças de Starling" data-img-description="Esta imagem ilustra as quatro Forças de Starling em um capilar. As setas indicam a direção de cada força: a Pressão Hidrostática Capilar (Pc) e a Coloidosmótica Intersticial (Πi) empurram o fluido para fora, enquanto a Pressão Coloidosmótica Plasmática (Πp) e a Hidrostática Intersticial (Pi) o trazem para dentro. O balanço entre elas determina se ocorrerá filtração ou absorção.">
                            <svg viewBox="0 0 600 260" xmlns="http://www.w3.org/2000/svg" class="text-sm font-sans" fill="#1e293b">
                                <title>Diagrama das Forças de Starling</title>
                        
                                <!-- Defs for arrowheads -->
                                <defs>
                                    <marker id="arrow-down" viewBox="0 0 10 10" refX="5" refY="10" markerWidth="5" markerHeight="5" orient="auto-start-reverse">
                                        <path d="M 0 0 L 5 10 L 10 0 z" fill="black"></path>
                                    </marker>
                                    <marker id="arrow-up" viewBox="0 0 10 10" refX="5" refY="0" markerWidth="5" markerHeight="5" orient="auto-start-reverse">
                                        <path d="M 0 10 L 5 0 L 10 10 z" fill="black"></path>
                                    </marker>
                                </defs>
                        
                                <!-- Capillary vessel -->
                                <path d="M 25 80 H 575 V 180 H 25 Z" fill="#fca5a5" stroke="#b91c1c" stroke-width="1.5" stroke-dasharray="4"></path>
                                <ellipse cx="25" cy="130" rx="20" ry="50" fill="#f87171" stroke="#b91c1c" stroke-width="1.5" stroke-dasharray="4"></ellipse>
                        
                                <!-- Text and Arrows -->
                                <g text-anchor="middle" font-weight="500">
                                    <!-- Pressão Capilar (Pc) -->
                                    <text x="180" y="105">Pressão capilar</text>
                                    <text x="180" y="120">(Pc)</text>
                                    <line x1="180" y1="125" x2="180" y2="155" stroke="black" stroke-width="2" marker-end="url(#arrow-down)"></line>
                        
                                    <!-- Pressão do Líquido Intersticial (Pi) -->
                                    <text x="180" y="210">Pressão do líquido</text>
                                    <text x="180" y="225">intersticial (Pi)</text>
                                    <line x1="180" y1="200" x2="180" y2="160" stroke="black" stroke-width="2" marker-end="url(#arrow-up)"></line>
                        
                                    <!-- Pressão Coloidosmótica Plasmática (Πp) -->
                                    <text x="420" y="105">Pressão coloidosmótica</text>
                                    <text x="420" y="120">plasmática (Πp)</text>
                                    <line x1="420" y1="155" x2="420" y2="125" stroke="black" stroke-width="2" marker-end="url(#arrow-up)"></line>
                        
                                    <!-- Pressão Coloidosmótica do Líquido Intersticial (Πi) -->
                                    <text x="420" y="210">Pressão coloidosmótica</text>
                                    <text x="420" y="225">do líquido intersticial (Πi)</text>
                                    <line x1="420" y1="160" x2="420" y2="200" stroke="black" stroke-width="2" marker-end="url(#arrow-down)"></line>
                                </g>
                            </svg>
                        </div>
                    </div>
                </div>
            </div>
            <div class="topic-card" id="topic-filtracao-e-absorcao">
                <div class="summary">Filtração e Absorção</div>
                <div class="topic-content-wrapper">
                    <div class="topic-content">
                        <ul>
                            <li>O balanço das Forças de Starling determina o movimento resultante do fluido.</li>
                            <li><span class="term" data-description="Ocorre quando a soma das forças que empurram o líquido para fora é maior que a soma das forças que o puxam para dentro. Predomina na extremidade arterial do capilar, onde a Pc é mais alta.">Filtração</span>: Saída de líquido do capilar.</li>
                            <li><span class="term" data-description="Ocorre quando a soma das forças que puxam o líquido para dentro é maior. Predomina na extremidade venosa, onde a Pc é mais baixa.">Absorção</span>: Entrada de líquido no capilar.</li>
                            <li>A Pressão Efetiva de Filtração (PEF) é calculada como: <strong>PEF = (Pc + Πi) - (Pi + Πp)</strong>.</li>
                        </ul>
                    </div>
                </div>
            </div>
            <div class="topic-card" id="topic-extremos-capilares">
                <div class="summary">Extremidade Arterial vs. Venosa</div>
                <div class="topic-content-wrapper">
                    <div class="topic-content">
                        <ul>
                            <li><span class="term" data-description="Nesta ponta, a Pressão Hidrostática Capilar (Pc) é alta (ex: 35 mmHg), superando a Pressão Coloidosmótica Plasmática (Πp). O resultado é uma força efetiva para fora, causando filtração de líquido para o interstício.">Extremidade Arterial</span>: Domínio da Filtração.</li>
                            <li><span class="term" data-description="Aqui, com a perda de fluido, a Pc cai significativamente (ex: 15 mmHg), tornando-se menor que a Πp. O resultado é uma força efetiva para dentro, promovendo a reabsorção do líquido intersticial de volta para o capilar.">Extremidade Venosa</span>: Domínio da Reabsorção.</li>
                            <li>Este gradiente de pressão ao longo do capilar garante a troca contínua de nutrientes e resíduos.</li>
                        </ul>
                    </div>
                </div>
            </div>
            <div class="topic-card" id="topic-sistema-linfatico">
                <div class="summary">O Papel do Sistema Linfático</div>
                <div class="topic-content-wrapper">
                    <div class="topic-content">
                        <ul>
                            <li>Normalmente, a filtração é ligeiramente maior que a absorção. O excesso de líquido e proteínas no interstício é coletado pelo sistema linfático.</li>
                            <li>O <span class="term" data-description="Uma rede de vasos que atua como uma via acessória para retornar o excesso de fluido intersticial (agora chamado de linfa) e proteínas de volta à circulação sanguínea.">sistema linfático</span> é crucial para prevenir o acúmulo de líquido nos tecidos (edema).</li>
                            <li>O fluxo linfático normal é de cerca de 2 a 3 litros por dia.</li>
                            <li>Uma falha neste sistema leva ao <span class="term" data-description="Um tipo de edema causado pela obstrução ou remoção dos vasos linfáticos, resultando em acúmulo de líquido rico em proteínas no interstício.">linfedema</span>.</li>
                        </ul>
                        <div class="image-bubble" id="svg-microcirculacao" data-img-svg="true" data-img-alt="Diagrama da Microcirculação" data-img-description="Este esquema demonstra o fluxo de fluido na microcirculação. O sangue chega pela arteríola (vermelho), onde a 'Filtração resultante' empurra o fluido para o espaço intersticial. Na vênula (azul), a 'Absorção resultante' o traz de volta. O excesso de fluido que permanece no interstício é coletado pelos 'Vasos linfáticos' (verde) e retornado à circulação venosa.">
                           <svg viewBox="0 0 600 400" xmlns="http://www.w3.org/2000/svg" class="text-sm font-sans" fill="#475569">
                                <title>Diagrama da Microcirculação e Sistema Linfático</title>
                                
                                <!-- Interstitial space -->
                                <rect width="600" height="400" fill="#f0f4f8"></rect>
                                
                                <!-- Background Cells -->
                                <g stroke="#a855f7" stroke-width="1.5" fill="rgba(233, 213, 255, 0.7)">
                                    <path d="M 100 50 C 120 30, 160 30, 180 50 C 200 70, 160 90, 140 80 C 120 70, 80 70, 100 50 Z"></path>
                                    <path d="M 250 80 C 270 60, 310 60, 330 80 C 350 100, 310 120, 290 110 C 270 100, 230 100, 250 80 Z"></path>
                                    <path d="M 450 60 C 470 40, 510 40, 530 60 C 550 80, 510 100, 490 90 C 470 80, 430 80, 450 60 Z"></path>
                                    <path d="M 50 250 C 70 230, 110 230, 130 250 C 150 270, 110 290, 90 280 C 70 270, 30 270, 50 250 Z"></path>
                                    <path d="M 500 250 C 520 230, 560 230, 580 250 C 600 270, 560 290, 540 280 C 520 270, 480 270, 500 250 Z"></path>
                                     <path d="M 220 340 C 240 320, 280 320, 300 340 C 320 360, 280 380, 260 370 C 240 360, 200 360, 220 340 Z"></path>
                                </g>
                            
                                <!-- Lymphatic Vessel -->
                                <path d="M 200 320 C 250 300, 350 300, 480 320 L 490 200 C 450 190, 550 150, 560 100" stroke="rgba(22, 163, 74, 0.6)" stroke-width="30" fill="none" stroke-linecap="round" stroke-linejoin="round"></path>
                                <path d="M 200 320 C 250 300, 350 300, 480 320 L 490 200 C 450 190, 550 150, 560 100" stroke="#16a34a" stroke-width="20" fill="none" stroke-linecap="round" stroke-linejoin="round"></path>
                                
                                <!-- Blood Vessels -->
                                <path d="M 0 100 C 100 80, 200 150, 300 200 C 400 250, 500 200, 600 180" stroke-width="40" stroke="rgba(59, 130, 246, 0.6)" fill="none" stroke-linecap="round"></path>
                                <path d="M 0 100 C 100 80, 200 150, 300 200 C 400 250, 500 200, 600 180" stroke-width="30" stroke="#3b82f6" fill="none" stroke-linecap="round"></path>
                                <path d="M 0 100 C 100 80, 180 140, 250 180" stroke-width="40" stroke="rgba(239, 68, 68, 0.6)" fill="none" stroke-linecap="round"></path>
                                <path d="M 0 100 C 100 80, 180 140, 250 180" stroke-width="30" stroke="#ef4444" fill="none" stroke-linecap="round"></path>
                            
                                <!-- Arrows -->
                                <defs>
                                    <marker id="arrowhead-black" viewbox="0 0 10 10" refx="8" refy="5" markerwidth="4" markerheight="4" orient="auto-start-reverse">
                                        <path d="M 0 0 L 10 5 L 0 10 z" fill="black"></path>
                                    </marker>
                                </defs>
                                
                                <!-- Flow Arrows -->
                                <path d="M 80 50 V 90" stroke="black" stroke-width="3" marker-end="url(#arrowhead-black)"></path> <!-- Arteriole In -->
                                <path d="M 180 130 Q 150 200 220 220" stroke="black" stroke-width="4" fill="none" marker-end="url(#arrowhead-black)"></path> <!-- Filtration -->
                                <path d="M 240 200 Q 250 250 260 285" stroke="black" stroke-width="4" fill="none" marker-end="url(#arrowhead-black)"></path> <!-- New arrow from arteriole side to lymph -->
                                <path d="M 400 250 Q 380 200 420 180" stroke="black" stroke-width="4" fill="none" marker-end="url(#arrowhead-black)"></path> <!-- Absorption -->
                                <path d="M 350 280 Q 400 250 450 220" stroke="black" stroke-width="4" fill="none" marker-end="url(#arrowhead-black)"></path> <!-- Lymph -->
                                <path d="M 550 110 V 70" stroke="black" stroke-width="3" marker-end="url(#arrowhead-black)"></path> <!-- Venous Out -->
                                
                                <!-- Labels -->
                                <g font-weight="600" text-anchor="middle">
                                    <rect x="25" y="20" width="80" height="28" rx="14" fill="rgba(255,255,255,0.85)"></rect>
                                    <text x="65" y="39" fill="#b91c1c">Arteríola</text>
                                    
                                    <rect x="490" y="200" width="80" height="28" rx="14" fill="rgba(255,255,255,0.85)"></rect>
                                    <text x="530" y="219" fill="#3b82f6">Vênula</text>
                            
                                    <rect x="180" y="100" width="130" height="28" rx="14" fill="rgba(255,255,255,0.85)"></rect>
                                    <text x="245" y="119" fill="#1e293b">Filtração resultante</text>
                            
                                    <rect x="300" y="220" width="130" height="28" rx="14" fill="rgba(255,255,255,0.85)"></rect>
                                    <text x="365" y="239" fill="#1e293b">Absorção resultante</text>
                            
                                    <rect x="200" y="330" width="120" height="28" rx="14" fill="rgba(255,255,255,0.85)"></rect>
                                    <text x="260" y="349" fill="#10b981">Vasos linfáticos</text>
                                    
                                    <rect x="420" y="20" width="160" height="28" rx="14" fill="rgba(255,255,255,0.85)"></rect>
                                    <text x="500" y="39" fill="#1e293b">Para a circulação venosa</text>
                                </g>
                            </svg>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </section>

    <!-- Fluid Imbalances Section -->
    <section id="desequilibrios" class="section-container">
        <div class="section-header-card">
            <h2 class="section-title">Desequilíbrios Hídricos</h2>
            <p class="section-subtitle">Quando o delicado balanço dos líquidos é perturbado, podem surgir condições como edema, desidratação e distúrbios eletrolíticos, afetando a função de todo o organismo.</p>
        </div>
        <div class="topics-grid">
            <div class="topic-card" id="topic-edema-extracelular">
                <div class="summary">Causas do Edema Extracelular</div>
                <div class="topic-content-wrapper">
                    <div class="topic-content">
                        <ul>
                            <li>Ocorre por aumento da filtração ou falha na drenagem. As principais causas são:</li>
                            <li><strong>Aumento da Pc:</strong> <span class="term" data-description="O coração fraco não bombeia o sangue eficientemente, aumentando a pressão venosa e, consequentemente, a pressão hidrostática capilar, o que força o líquido para o interstício.">Insuficiência cardíaca</span> e obstrução venosa.</li>
                            <li><strong>Diminuição da Πp:</strong> <span class="term" data-description="O fígado doente produz menos albumina, a principal proteína plasmática. Com menos proteína no sangue, a força que retém líquido dentro dos vasos diminui.">Cirrose hepática</span> ou <span class="term" data-description="Os rins danificados perdem grandes quantidades de albumina na urina, diminuindo a pressão coloidosmótica do plasma.">síndrome nefrótica</span>.</li>
                            <li><strong>Aumento da Permeabilidade:</strong> Em reações inflamatórias ou queimaduras, os capilares se tornam mais 'vazados'.</li>
                            <li><strong>Obstrução Linfática:</strong> Bloqueio da drenagem do excesso de líquido, como em infecções (filariose) ou após cirurgias.</li>
                        </ul>
                    </div>
                </div>
            </div>
            <div class="topic-card" id="topic-edema-intracelular">
                <div class="summary">Causas do Edema Intracelular</div>
                <div class="topic-content-wrapper">
                    <div class="topic-content">
                        <ul>
                            <li>Ocorre quando as células incham por entrada excessiva de água. As duas causas principais são:</li>
                            <li><span class="term" data-description="A baixa concentração de sódio no LEC torna este meio hipotônico em relação ao LIC. A água então se move por osmose para dentro das células para equilibrar as concentrações, causando o inchaço celular.">Hiponatremia</span>: Baixo sódio no LEC.</li>
                            <li><span class="term" data-description="Se o metabolismo celular está prejudicado (ex: por falta de oxigênio), a bomba de sódio e potássio pode falhar. O sódio se acumula dentro da célula, tornando o LIC hipertônico e puxando água para dentro.">Depressão Metabólica</span>: Falha das bombas iônicas.</li>
                            <li>Este tipo de edema é particularmente perigoso para o cérebro, onde o inchaço é limitado pelo crânio.</li>
                        </ul>
                    </div>
                </div>
            </div>
            <div class="topic-card" id="topic-osmolaridade">
                <div class="summary">Balanço Hídrico e Osmolaridade</div>
                <div class="topic-content-wrapper">
                    <div class="topic-content">
                        <ul>
                            <li>A água se move livremente entre os compartimentos para equilibrar a <span class="term" data-description="É a medida da concentração total de solutos em uma solução. Em condições normais, a osmolaridade do LIC e do LEC é a mesma (isotônicos), cerca de 280-300 mOsm/L.">osmolaridade</span>.</li>
                            <li>Adição de solução <span class="term" data-description="Uma solução com a mesma osmolaridade que os fluidos corporais. A infusão de soro isotônico aumenta apenas o volume do LEC, sem alterar o volume do LIC.">isotônica</span>: Aumenta o volume do LEC.</li>
                            <li>Adição de solução <span class="term" data-description="Uma solução menos concentrada. A infusão de soro hipotônico faz com que a água entre nas células, aumentando tanto o volume do LEC quanto do LIC.">hipotônica</span>: Aumenta o volume do LEC e do LIC.</li>
                            <li>Adição de solução <span class="term" data-description="Uma solução mais concentrada. A infusão de soro hipertônico 'puxa' a água de dentro das células, aumentando o volume do LEC e diminuindo o do LIC.">hipertônica</span>: Aumenta o volume do LEC e diminui o do LIC.</li>
                        </ul>
                    </div>
                </div>
            </div>
            <div class="topic-card" id="topic-hipo-e-hipernatremia">
                <div class="summary">Hiponatremia e Hipernatremia</div>
                <div class="topic-content-wrapper">
                    <div class="topic-content">
                        <ul>
                            <li>A concentração de Sódio (Na⁺) no plasma é o principal indicador da osmolaridade do LEC.</li>
                            <li><span class="term" data-description="Baixa concentração de sódio no plasma (<135 mEq/L). Pode ser causada por perda de sódio (vômito, diarreia) ou excesso de água. Causa edema celular, especialmente perigoso no cérebro.">Hiponatremia</span>: Baixo Sódio.</li>
                            <li><span class="term" data-description="Alta concentração de sódio no plasma (>145 mEq/L). Pode ser causada por perda de água (desidratação, diabetes insípido) ou excesso de sódio. Causa retração (encolhimento) celular.">Hipernatremia</span>: Alto Sódio.</li>
                            <li>Ambas as condições podem levar a graves disfunções neurológicas devido às alterações no volume das células cerebrais.</li>
                        </ul>
                         <div class="image-bubble" id="svg-intersticial-plasma" data-img-svg="true" data-img-alt="Gráfico de Íons no Fluido Intersticial e Plasma" data-img-description="Este gráfico de barras mostra a composição iônica do fluido intersticial e do plasma, ambos componentes do LEC. Observe como as concentrações são muito semelhantes, com alta presença de Sódio (Na+), Cloreto (Cl-) e Bicarbonato (HCO3-). A principal diferença é a pequena quantidade de proteínas no plasma, que está quase ausente no interstício.">
                             <svg viewBox="0 0 550 400" xmlns="http://www.w3.org/2000/svg" class="text-sm font-sans" fill="#475569">
                                <title>Composição Iônica do Fluido Intersticial e Plasma</title>
                                <!-- Y Axis -->
                                <line x1="40" y1="50" x2="40" y2="350" stroke="#475569" stroke-width="1.5"></line>
                                <line x1="40" y1="350" x2="520" y2="350" stroke="#475569" stroke-width="1.5"></line>
                                <text x="10" y="55" text-anchor="middle">160</text>
                                <text x="10" y="115" text-anchor="middle">120</text>
                                <text x="10" y="175" text-anchor="middle">80</text>
                                <text x="10" y="235" text-anchor="middle">40</text>
                                <text x="10" y="295" text-anchor="middle">20</text>
                                <text x="10" y="355" text-anchor="middle">0</text>
                                <text x="5" y="200" text-anchor="middle" writing-mode="vertical-rl" font-size="0.9em" font-weight="500">Concentração (mM)</text>
                                <!-- X Axis Labels -->
                                <g>
                                    <rect x="100" y="362" width="120" height="25" rx="5" fill="rgba(255,255,255,0.8)"></rect>
                                    <text x="160" y="378" text-anchor="middle" font-weight="600" fill="#1e293b">Fluido intersticial</text>
                                </g>
                                <g>
                                    <rect x="370" y="362" width="80" height="25" rx="5" fill="rgba(255,255,255,0.8)"></rect>
                                    <text x="410" y="378" text-anchor="middle" font-weight="600" fill="#1e293b">Plasma</text>
                                </g>
                                <!-- Interstitial Bars -->
                                <rect x="60" y="66" width="35" height="284" fill="#fde047" stroke="#facc15" stroke-width="1"></rect> <!-- Na+ 142 -->
                                <text x="77.5" y="60" text-anchor="middle">Na⁺</text>
                                <rect x="105" y="122" width="35" height="228" fill="#cffafe" stroke="#67e8f9" stroke-width="1"></rect> <!-- Cl- 114 -->
                                <text x="122.5" y="116" text-anchor="middle">Cl⁻</text>
                                <rect x="150" y="294" width="35" height="56" fill="#86efac" stroke="#4ade80" stroke-width="1"></rect> <!-- HCO3- 28 -->
                                <text x="167.5" y="288" text-anchor="middle">HCO₃⁻</text>
                                <rect x="195" y="340" width="20" height="10" fill="#fecaca" stroke="#f87171" stroke-width="1"></rect> <!-- K+ 5 -->
                                <text x="205" y="335" text-anchor="middle">K⁺</text>
                                <!-- Plasma Bars -->
                                <rect x="310" y="70" width="35" height="280" fill="#fde047" stroke="#facc15" stroke-width="1"></rect> <!-- Na+ 140 -->
                                <text x="327.5" y="64" text-anchor="middle">Na⁺</text>
                                <rect x="355" y="142" width="35" height="208" fill="#cffafe" stroke="#67e8f9" stroke-width="1"></rect> <!-- Cl- 104 -->
                                <text x="372.5" y="136" text-anchor="middle">Cl⁻</text>
                                <rect x="400" y="300" width="35" height="50" fill="#86efac" stroke="#4ade80" stroke-width="1"></rect> <!-- HCO3- 25 -->
                                <text x="417.5" y="294" text-anchor="middle">HCO₃⁻</text>
                                <rect x="445" y="340" width="20" height="10" fill="#fecaca" stroke="#f87171" stroke-width="1"></rect> <!-- K+ 5 -->
                                <text x="455" y="335" text-anchor="middle">K⁺</text>
                                <rect x="475" y="320" width="20" height="30" fill="#fbcfe8" stroke="#f472b6" stroke-width="1"></rect> <!-- Proteínas 15 -->
                                <text x="485" y="314" text-anchor="middle" font-size="0.8em">Proteínas</text>
                            </svg>
                        </div>
                    </div>
                </div>
            </div>
            <div class="topic-card" id="topic-riscos-correcao-hiponatremia">
                <div class="summary">Riscos da Correção Rápida</div>
                <div class="topic-content-wrapper">
                    <div class="topic-content">
                        <ul>
                            <li>Um ponto clínico crucial no tratamento da hiponatremia.</li>
                            <li>Na <span class="term" data-description="Quando a hiponatremia se instala lentamente (dias), as células cerebrais se adaptam expulsando solutos (K+, Na+, solutos orgânicos) para diminuir sua osmolaridade interna e evitar o inchaço excessivo.">hiponatremia crônica</span>, o cérebro se adapta.</li>
                            <li>Se a concentração de sódio no plasma for corrigida muito rapidamente com uma solução hipertônica, o LEC se torna subitamente hipertônico.</li>
                            <li>As células cerebrais, que já perderam seus solutos, não conseguem recuperá-los a tempo. A água é "puxada" violentamente para fora delas.</li>
                            <li>Isso causa uma desidratação celular abrupta, que pode levar a uma grave lesão neurológica chamada <span class="term" data-description="Uma condição neurológica devastadora causada pela correção excessivamente rápida da hiponatremia, que leva à destruição da bainha de mielina dos neurônios.">síndrome de desmielinização osmótica</span>.</li>
                        </ul>
                    </div>
                </div>
            </div>
        </div>
    </section>

    <!-- Quiz Section -->
    <section id="quiz-section" class="section-container">
        <div class="section-header-card">
            <h2 class="section-title">Teste seu Conhecimento</h2>
            <p class="section-subtitle">Vamos ver o que você aprendeu! Responda às perguntas a seguir para testar sua compreensão sobre os líquidos corporais.</p>
        </div>

        <div id="quiz-area" class="w-full max-w-3xl flex flex-col items-center">
            <div id="quiz-container" class="quiz-container hidden">
                <div id="quiz-timer">30</div>
                <h3 id="quiz-question"></h3>
                <ul id="quiz-options"></ul>
            </div>
            <div id="quiz-results" class="quiz-container hidden">
                <h3>Quiz Finalizado!</h3>
                <div id="quiz-percentage">100%</div>
                <div class="results-stats">
                    <span id="stat-correct-count" class="stat-correct"></span>
                    <span id="stat-incorrect-count" class="stat-incorrect"></span>
                </div>
                <h4 class="text-lg font-semibold mt-6 mb-2 text-slate-700">Tópicos para revisar:</h4>
                <ul id="missed-topics-list"></ul>
                 <button id="restart-quiz-btn">Novo Quiz</button>
            </div>
            <button id="quiz-start-btn">Começar Quiz</button>
        </div>
    </section>

    <!-- Footer -->
    <footer class="footer-signature">
        <p>Feito por Rafael Chaves Sebe</p>
    </footer>

    <!-- Modal Structure -->
    <div id="modal-overlay" class="fixed inset-0">
        <div id="modal-content" class="relative">
             <button id="modal-close-btn" class="absolute top-4 right-4 z-20">&times;</button>
            <div id="modal-header" class="relative hidden">
                <h3 id="modal-title"></h3>
            </div>
            <div id="modal-image-container" class="hidden">
                 <!-- SVG will be injected here by JS -->
            </div>
            <p id="modal-description"></p>
        </div>
    </div>

    <script>
        document.addEventListener('DOMContentLoaded', () => {
            // Observer for section background changes
            const bgObserver = new IntersectionObserver((entries) => {
                entries.forEach(entry => {
                    const glowId = `bg-${entry.target.id}`;
                    const glowEl = document.getElementById(glowId);
                    if (glowEl) {
                        if (entry.isIntersecting) {
                            glowEl.style.opacity = '0.25';
                        } else {
                            glowEl.style.opacity = '0';
                        }
                    }
                });
            }, { threshold: 0.4 }); 

            document.querySelectorAll('#fundamentos, #trocas, #desequilibrios').forEach(section => {
                bgObserver.observe(section);
            });

            // Observer for card animations
            const cardObserver = new IntersectionObserver((entries, observer) => {
                entries.forEach(entry => {
                    if (entry.isIntersecting) {
                        entry.target.classList.add('visible');
                    } else if (entry.boundingClientRect.top > 0) {
                        entry.target.classList.remove('visible');
                    }
                });
            }, {
                threshold: 0.01
            });
            document.querySelectorAll('.topic-card, .section-header-card').forEach(card => {
                cardObserver.observe(card);
            });

            // Modal logic
            const modalOverlay = document.getElementById('modal-overlay');
            const modalContent = document.getElementById('modal-content');
            const modalHeader = document.getElementById('modal-header');
            const modalTitle = document.getElementById('modal-title');
            const modalDescription = document.getElementById('modal-description');
            const modalCloseBtn = document.getElementById('modal-close-btn');
            const modalImageContainer = document.getElementById('modal-image-container');

            function openModal() {
                modalOverlay.classList.add('visible');
                document.body.style.overflow = 'hidden';
            }

            const closeModal = () => {
                modalOverlay.classList.remove('visible');
                setTimeout(() => {
                    if (!modalOverlay.classList.contains('visible')) {
                         document.body.style.overflow = '';
                         // Limpa o conteúdo do gráfico ao fechar para evitar que o antigo apareça
                         modalImageContainer.innerHTML = '';
                    }
                }, 400); 
            };

            // Event Listeners for Terms
            document.querySelectorAll('.term').forEach(term => {
                term.addEventListener('click', (event) => {
                    event.preventDefault();
                    const title = term.textContent;
                    const description = term.getAttribute('data-description');
                    const parentSection = term.closest('section');
                    let theme = 'fundamentos'; 
                    if (parentSection && parentSection.id) {
                       if (parentSection.id === 'trocas') theme = 'trocas';
                       else if (parentSection.id === 'desequilibrios') theme = 'desequilibrios';
                    }
                    
                    modalContent.classList.remove('image-modal');
                    modalHeader.classList.remove('hidden');
                    modalImageContainer.classList.add('hidden');
                    
                    modalTitle.textContent = title;
                    modalDescription.textContent = description;
                    
                    modalContent.className = 'relative'; 
                    modalHeader.className = '';
                    modalContent.classList.add(`theme-${theme}`);
                    modalHeader.classList.add(`theme-${theme}`);
                    
                    openModal();
                });
            });

             // Event Listeners for Images/SVGs
            document.querySelectorAll('.image-bubble').forEach(bubble => {
                bubble.addEventListener('click', () => {
                    const isSvg = bubble.dataset.imgSvg === 'true';
                    const description = bubble.dataset.imgDescription;
                    const parentSection = bubble.closest('section');
                     let theme = 'fundamentos'; 
                    if (parentSection && parentSection.id) {
                       if (parentSection.id === 'trocas') theme = 'trocas';
                       else if (parentSection.id === 'desequilibrios') theme = 'desequilibrios';
                    }

                    modalContent.classList.add('image-modal');
                    modalHeader.classList.add('hidden');
                    modalImageContainer.classList.remove('hidden');
                    
                    if (isSvg) {
                       const svgElement = bubble.querySelector('svg');
                       modalImageContainer.innerHTML = svgElement.outerHTML;
                    } 
                    
                    modalDescription.textContent = description;

                    modalContent.className = 'relative image-modal'; 
                    modalContent.classList.add(`theme-${theme}`);

                    openModal();
                });
            });

            modalCloseBtn.addEventListener('click', closeModal);
            modalOverlay.addEventListener('click', (event) => {
                if (event.target === modalOverlay) closeModal();
            });
            
            // Accordion logic
            document.querySelectorAll('.topic-card .summary').forEach(summary => {
                summary.addEventListener('click', (e) => {
                    const card = e.currentTarget.parentElement;
                    toggleAccordion(card);
                });
            });

            function toggleAccordion(cardToToggle) {
                const contentWrapper = cardToToggle.querySelector('.topic-content-wrapper');
                const isOpen = cardToToggle.classList.contains('is-open');

                const parentGrid = cardToToggle.closest('.topics-grid');
                parentGrid.querySelectorAll('.topic-card.is-open').forEach(openCard => {
                    if (openCard !== cardToToggle) {
                        const otherContentWrapper = openCard.querySelector('.topic-content-wrapper');
                        otherContentWrapper.style.maxHeight = '0px';
                        openCard.classList.remove('is-open');
                    }
                });

                if (isOpen) {
                    contentWrapper.style.maxHeight = '0px';
                    cardToToggle.classList.remove('is-open');
                } else {
                    const content = cardToToggle.querySelector('.topic-content');
                    contentWrapper.style.maxHeight = content.scrollHeight + 'px';
                    cardToToggle.classList.add('is-open');
                }
            }
            
            // ===================================
            // == QUIZ LOGIC
            // ===================================
            const questionBank = [
                // LIC e LEC
                { question: "Qual compartimento contém a maior parte da água corporal total?", topic: "Líquido Intracelular (LIC) vs. Extracelular (LEC)", options: ["Líquido intersticial", "Plasma sanguíneo", "Líquido extracelular (LEC)", "Líquido intracelular (LIC)"], correctAnswer: 3, originalIndex: 0 },
                { question: "O Líquido Extracelular (LEC) é composto principalmente por:", topic: "Líquido Intracelular (LIC) vs. Extracelular (LEC)", options: ["Plasma e linfa", "Líquido intersticial e plasma", "Apenas plasma", "Apenas líquido dentro das células"], correctAnswer: 1, originalIndex: 1 },
                // Composição Iônica
                { question: "Observando o gráfico, qual é o principal cátion encontrado no Líquido Intracelular (LIC)?", topic: "Composição Iônica", options: ["Sódio (Na+)", "Cálcio (Ca++)", "Potássio (K+)", "Magnésio (Mg++)"], correctAnswer: 2, originalIndex: 2, svgId: "svg-composicao-ionica" },
                { question: "Com base no gráfico de Composição Iônica, qual afirmação sobre o Líquido Extracelular (LEC) é correta?", topic: "Composição Iônica", options: ["A concentração de K⁺ é maior que a de Na⁺.", "A concentração de Proteínas é a mais alta.", "A concentração de Na⁺ é a mais alta entre todos os íons.", "A concentração de Cl⁻ é maior que a de Na⁺."], correctAnswer: 2, originalIndex: 3, svgId: "svg-composicao-ionica" },
                // Hematócrito
                { question: "O que o hematócrito mede?", topic: "Volume Sanguíneo e Hematócrito", options: ["A porcentagem de plasma no sangue", "A porcentagem de hemácias no volume total de sangue", "A concentração de proteínas no plasma", "O volume total de sangue no corpo"], correctAnswer: 1, originalIndex: 4 },
                // Balanço de Massa
                { question: "De acordo com a Lei do Balanço de Massa, o que acontece se a excreção de água for maior que a ingestão?", topic: "A Lei do Balanço de Massa", options: ["Ocorre acúmulo de água", "Ocorre uma perda líquida de água (desidratação)", "O volume de água corporal permanece o mesmo", "A produção metabólica de água aumenta"], correctAnswer: 1, originalIndex: 6 },
                // Forças de Starling
                { question: "Analisando o diagrama, qual das Forças de Starling 'puxa' a água de volta para dentro do capilar?", topic: "As Forças de Starling", options: ["Pressão hidrostática capilar (Pc)", "Pressão coloidosmótica intersticial (Πi)", "Pressão coloidosmótica plasmática (Πp)", "Pressão hidrostática intersticial (Pi)"], correctAnswer: 2, originalIndex: 7, svgId: "svg-forcas-starling" },
                { question: "Com base no diagrama, quais duas forças se opõem diretamente à saída de líquido do capilar (ou seja, favorecem a ENTRADA)?", topic: "As Forças de Starling", options: ["Pc e Πi", "Pi e Πp", "Pc e Πp", "Pi e Πi"], correctAnswer: 1, originalIndex: 8, svgId: "svg-forcas-starling"},
                // Filtração e Absorção
                { question: "Na extremidade arterial de um capilar, qual processo geralmente predomina?", topic: "Filtração e Absorção", options: ["Absorção", "Equilíbrio", "Filtração", "Nenhum dos dois"], correctAnswer: 2, originalIndex: 9 },
                // Sistema Linfático
                { question: "De acordo com o Diagrama da Microcirculação, o que acontece com o excesso de fluido que sai do capilar e não é reabsorvido?", topic: "O Papel do Sistema Linfático", options: ["Ele evapora", "Ele é coletado pelos vasos linfáticos", "Ele retorna para a arteríola", "Ele é absorvido pelas células"], correctAnswer: 1, originalIndex: 11, svgId: "svg-microcirculacao" },
                // Edema Extracelular
                { question: "Um paciente com insuficiência cardíaca grave desenvolve edema. Qual é a causa mais provável?", topic: "Causas do Edema Extracelular", options: ["Aumento da pressão hidrostática capilar", "Diminuição da pressão hidrostática capilar", "Aumento da pressão coloidosmótica plasmática", "Diminuição da permeabilidade capilar"], correctAnswer: 0, originalIndex: 12 },
                { question: "A perda de grandes quantidades de albumina pela urina (síndrome nefrótica) causa edema por qual mecanismo?", topic: "Causas do Edema Extracelular", options: ["Aumento da Πi", "Aumento da Pc", "Diminuição da Πp", "Diminuição da Pi"], correctAnswer: 2, originalIndex: 13 },
                // Edema Intracelular
                { question: "Qual das seguintes condições causa edema intracelular ao tornar o LEC hipotônico?", topic: "Causas do Edema Intracelular", options: ["Hipernatremia", "Hiponatremia", "Aumento de proteínas no plasma", "Desidratação"], correctAnswer: 1, originalIndex: 14 },
                // Hipo e Hipernatremia
                { question: "Observando o gráfico, qual é a diferença mais notável entre o Fluido Intersticial e o Plasma?", topic: "Hiponatremia e Hipernatremia", options: ["A concentração de Sódio (Na⁺) é muito diferente.", "A concentração de Potássio (K⁺) é oposta.", "O plasma contém proteínas, enquanto o interstício quase não tem.", "O fluido intersticial tem mais Cloreto (Cl⁻) que o plasma."], correctAnswer: 2, originalIndex: 16, svgId: "svg-intersticial-plasma" },
                 // Riscos da Correção
                { question: "Por que a correção excessivamente rápida da hiponatremia crônica é perigosa?", topic: "Riscos da Correção Rápida", options: ["Pode causar um aumento súbito da pressão arterial", "Pode levar a uma desidratação abrupta das células cerebrais", "Pode sobrecarregar os rins com excesso de sódio", "Pode induzir uma reação alérgica grave"], correctAnswer: 1, originalIndex: 17 },
            ];

            const startBtn = document.getElementById('quiz-start-btn');
            const restartBtn = document.getElementById('restart-quiz-btn');
            const quizContainer = document.getElementById('quiz-container');
            const resultsContainer = document.getElementById('quiz-results');
            const questionEl = document.getElementById('quiz-question');
            const optionsEl = document.getElementById('quiz-options');
            const timerEl = document.getElementById('quiz-timer');
            
            let currentQuestionIndex = 0;
            let score = 0;
            let missedTopics = [];
            let timerInterval;
            let activeQuiz = [];
            let questionWeights = [];
            const topicIdMap = {};

            function initializeQuizSystem() {
                questionWeights = new Array(questionBank.length).fill(10); // Default weight

                document.querySelectorAll('.topic-card').forEach(card => {
                    const summaryText = card.querySelector('.summary').textContent.trim();
                    topicIdMap[summaryText] = card.id;
                });
            }

            function startQuiz() {
                activeQuiz = [];
                let availableQuestions = [...questionBank];
                
                const quizSize = 10;
                const weightedPool = [];
                availableQuestions.forEach(q => {
                    const weight = questionWeights[q.originalIndex];
                    for (let i = 0; i < weight; i++) {
                        weightedPool.push(q);
                    }
                });

                while(activeQuiz.length < quizSize && weightedPool.length > 0) {
                    const randomIndex = Math.floor(Math.random() * weightedPool.length);
                    const chosenQuestion = weightedPool[randomIndex];

                    if (!activeQuiz.some(q => q.originalIndex === chosenQuestion.originalIndex)) {
                        activeQuiz.push(chosenQuestion);
                    }
                    // Remove all instances of the chosen question from the pool
                    for (let i = weightedPool.length - 1; i >= 0; i--) {
                        if (weightedPool[i].originalIndex === chosenQuestion.originalIndex) {
                            weightedPool.splice(i, 1);
                        }
                    }
                }

                currentQuestionIndex = 0;
                score = 0;
                missedTopics = [];
                startBtn.classList.add('hidden');
                resultsContainer.classList.add('hidden');
                quizContainer.classList.remove('hidden');
                showQuestion();
            }

            function showQuestion() {
                resetState();
                if (currentQuestionIndex >= activeQuiz.length) {
                    showResults();
                    return;
                }
                const questionData = activeQuiz[currentQuestionIndex];

                // Add SVG if it exists for the question
                if (questionData.svgId) {
                    const svgContainer = document.getElementById(questionData.svgId);
                    if (svgContainer) {
                        const svgElement = svgContainer.querySelector('svg').cloneNode(true);
                        svgElement.classList.add('quiz-question-svg'); // Add class for easy removal
                        svgElement.style.maxWidth = '400px';
                        svgElement.style.margin = '0 auto 1.5rem auto';
                        svgElement.style.backgroundColor = 'rgba(255,255,255,0.4)';
                        svgElement.style.borderRadius = '1rem';
                        svgElement.style.padding = '0.5rem';
                        questionEl.parentNode.insertBefore(svgElement, questionEl);
                    }
                }

                questionEl.textContent = questionData.question;
                
                questionData.options.forEach((option, index) => {
                    const li = document.createElement('li');
                    li.textContent = option;
                    li.classList.add('quiz-option');
                    li.dataset.index = index;
                    li.addEventListener('click', selectAnswer);
                    optionsEl.appendChild(li);
                });
                
                startTimer();
            }

            function startTimer() {
                let timeLeft = 30;
                timerEl.textContent = timeLeft;
                timerInterval = setInterval(() => {
                    timeLeft--;
                    timerEl.textContent = timeLeft;
                    if (timeLeft <= 0) {
                        clearInterval(timerInterval);
                        selectAnswer(null); // Time's up
                    }
                }, 1000);
            }

            function resetState() {
                clearInterval(timerInterval);
                const existingSvg = quizContainer.querySelector('.quiz-question-svg');
                if (existingSvg) {
                    existingSvg.remove();
                }
                while(optionsEl.firstChild) {
                    optionsEl.removeChild(optionsEl.firstChild);
                }
                document.body.classList.remove('correct-bg', 'incorrect-bg');
            }
            
            function selectAnswer(e) {
                clearInterval(timerInterval);
                const selectedOption = e ? e.target : null;
                const currentQuestion = activeQuiz[currentQuestionIndex];
                const correctIndex = currentQuestion.correctAnswer;
                const originalIndex = currentQuestion.originalIndex;
                let isCorrect = false;

                if(selectedOption && parseInt(selectedOption.dataset.index) === correctIndex) {
                    isCorrect = true;
                }
                
                Array.from(optionsEl.children).forEach((optionNode, index) => {
                    optionNode.classList.add('disabled');
                    if (index === correctIndex) {
                        optionNode.classList.add('correct-answer');
                    }
                });

                if (isCorrect) {
                    score++;
                    if(selectedOption) selectedOption.classList.add('correct-answer');
                    document.body.classList.add('correct-bg');
                    questionWeights[originalIndex] = Math.max(1, Math.floor(questionWeights[originalIndex] / 2));
                } else {
                    if (selectedOption) {
                        selectedOption.classList.add('incorrect-answer');
                    }
                    missedTopics.push(currentQuestion.topic);
                    document.body.classList.add('incorrect-bg');
                    questionWeights[originalIndex] = Math.min(50, questionWeights[originalIndex] * 2);
                }

                setTimeout(() => {
                    currentQuestionIndex++;
                    if(currentQuestionIndex < activeQuiz.length) {
                        showQuestion();
                    } else {
                        showResults();
                    }
                }, 2500); 
            }
            
            function showResults() {
                resetState();
                quizContainer.classList.add('hidden');
                resultsContainer.classList.remove('hidden');

                const percentage = activeQuiz.length > 0 ? Math.round((score / activeQuiz.length) * 100) : 0;
                document.getElementById('quiz-percentage').textContent = `${percentage}%`;
                document.getElementById('stat-correct-count').textContent = `✔️ ${score} Acertos`;
                document.getElementById('stat-incorrect-count').textContent = `❌ ${activeQuiz.length - score} Erros`;
                
                const missedListEl = document.getElementById('missed-topics-list');
                missedListEl.innerHTML = '';
                
                if (missedTopics.length > 0) {
                     const uniqueMissedTopics = [...new Set(missedTopics)];
                     uniqueMissedTopics.forEach(topic => {
                         const cardId = Object.keys(topicIdMap).find(key => topic.includes(key));
                         if (!topicIdMap[cardId]) {
                             console.warn(`Could not find ID for topic: "${topic}"`);
                             return;
                         };

                         const bubble = document.createElement('li');
                         bubble.textContent = cardId;
                         bubble.classList.add('missed-topic-bubble');

                         bubble.addEventListener('click', (e) => {
                             const targetCard = document.getElementById(topicIdMap[cardId]);
                             if (targetCard) {
                                 e.currentTarget.classList.add('visited-topic');
                                 targetCard.scrollIntoView({ behavior: 'smooth', block: 'center' });
                                 if (!targetCard.classList.contains('is-open')) {
                                     toggleAccordion(targetCard);
                                 }
                             }
                         });

                         missedListEl.appendChild(bubble);
                     });
                } else {
                     const congrats = document.createElement('li');
                     congrats.textContent = "Parabéns, você acertou tudo!";
                     congrats.classList.add('text-green-600', 'font-semibold');
                     missedListEl.appendChild(congrats);
                }
            }

            initializeQuizSystem();
            startBtn.addEventListener('click', startQuiz);
            restartBtn.addEventListener('click', startQuiz);
        });
    </script>
</body>
</html>
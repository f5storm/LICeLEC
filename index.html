<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>A Dinâmica dos Líquidos Corporais: Uma Análise Interativa</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700;800&display=swap" rel="stylesheet">
    <style>
        :root {
            /* == Theme Colors for Body Fluids == */
            --extracelular-color: #3b82f6;  /* Vibrant Blue for Extracellular */
            --intracelular-color: #f43f5e;  /* Vibrant Rose for Intracellular */
            --equilibrio-color: #84cc16;    /* Vibrant Lime for Balance/General */

            /* Glow/Highlight Colors for light theme */
            --extracelular-glow: rgba(59, 130, 246, 0.2);
            --intracelular-glow: rgba(244, 63, 94, 0.2);
            --equilibrio-glow: rgba(132, 204, 22, 0.2);
            
            /* Theme Border Colors for light theme */
            --extracelular-border: rgba(59, 130, 246, 0.4);
            --intracelular-border: rgba(244, 63, 94, 0.4);
            --equilibrio-border: rgba(132, 204, 22, 0.4);

            /* Light Theme Palette */
            --bg-main: #f8fafc;
            --text-primary: #1e293b;
            --text-secondary: #475569;
        }

        html { scroll-behavior: smooth; }
        body { 
            font-family: 'Inter', sans-serif; 
            color: var(--text-primary);
            overflow-x: hidden;
            background-color: var(--bg-main);
            transition: background-color 0.5s ease-in-out; /* For quiz feedback */
        }
        
        /* == Background color flash for Quiz == */
        body.correct-bg { background-color: #dcfce7; }
        body.incorrect-bg { background-color: #fee2e2; }

        /* Animated background shapes */
        .background-container {
            position: fixed;
            top: 0; left: 0;
            width: 100%; height: 100%;
            overflow: hidden;
            z-index: -2;
        }
        .light-bubble {
            position: absolute;
            border-radius: 50%;
            filter: blur(140px);
            opacity: 0.15; 
            animation: moveBubble 35s infinite alternate;
        }
        .light-bubble.b1 { width: 45vw; height: 45vw; top: 5%; left: -10%; background: var(--extracelular-color); animation-duration: 40s; }
        .light-bubble.b2 { width: 45vw; height: 45vw; top: 40%; left: 70%; background: var(--intracelular-color); animation-duration: 35s; }
        .light-bubble.b3 { width: 50vw; height: 50vw; top: 60%; left: 10%; background: var(--equilibrio-color); animation-duration: 45s; }

        @keyframes moveBubble {
            0% { transform: translate(0, 0) scale(1); }
            100% { transform: translate(15vw, -20vh) scale(1.2); }
        }
        
        /* Dynamic background glows for transitions */
        .dynamic-bg-glow {
            position: fixed;
            top: 50%;
            left: 50%;
            width: 150vmax;
            height: 150vmax;
            transform: translate(-50%, -50%);
            border-radius: 50%;
            filter: blur(120px);
            opacity: 0;
            transition: opacity 1.5s ease-in-out;
            z-index: -1;
        }
        #bg-fundamentos { background-color: var(--equilibrio-color); }
        #bg-trocas { background-color: var(--extracelular-color); }
        #bg-desequilibrios { background-color: var(--intracelular-color); }

        .section-container {
            width: 100%;
            padding: 7rem 2rem;
            display: flex;
            justify-content: center;
            align-items: center;
            flex-direction: column;
            position: relative;
            z-index: 1;
        }
        
        #hero { 
            min-height: 90vh; 
            padding-top: 2rem; 
            padding-bottom: 2rem;
        }
        #hero h1 { 
            font-size: clamp(2.8rem, 7vw, 5rem); 
            font-weight: 800; 
            letter-spacing: -0.05em; 
            text-shadow: 0 0 20px rgba(0,0,0,0.05);
        }
        #hero p { 
            font-size: clamp(1.1rem, 2.5vw, 1.35rem); 
            max-width: 650px; 
            color: var(--text-secondary);
            margin-left: auto;
            margin-right: auto;
        }

        .section-header-card {
            position: relative;
            background: rgba(255, 255, 255, 0.35);
            backdrop-filter: blur(20px);
            -webkit-backdrop-filter: blur(20px);
            border: 1px solid rgba(255, 255, 255, 0.2);
            border-radius: 1.5rem;
            padding: 2.5rem;
            margin-bottom: 3rem;
            box-shadow: 0 8px 32px 0 rgba(0, 0, 0, 0.1);
            text-align: center;
            max-width: 1200px;
            width: 100%;
            overflow: hidden;
            z-index: 2;
            opacity: 0;
            transform: translateY(50px);
            transition: opacity 0.5s ease-out, transform 0.5s cubic-bezier(0.25, 0.46, 0.45, 0.94);
        }
        .section-header-card.visible {
            opacity: 1;
            transform: translateY(0);
        }
        .section-header-card::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            border-radius: inherit;
            pointer-events: none;
            box-shadow: inset 0 0 0 1.5px rgba(255, 255, 255, 0.6);
            z-index: 1;
        }
        .section-header-card > * {
             position: relative;
             z-index: 2;
        }
        .section-header-card .section-title {
            margin-bottom: 1rem;
        }
        #hero .section-header-card { margin-bottom: 0; } 

        .section-title { font-size: clamp(2.2rem, 5.5vw, 4rem); font-weight: 800; letter-spacing: -0.04em; color: var(--text-primary); position: relative; }
        .section-subtitle { 
            font-size: clamp(1rem, 2vw, 1.2rem); 
            max-width: 700px; 
            color: var(--text-secondary); 
            margin-bottom: 0;
            margin-left: auto; 
            margin-right: auto; 
        }

        .topics-grid {
            width: 100%;
            max-width: 1200px;
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(320px, 1fr));
            gap: 1.5rem;
            align-items: start;
        }

        .topic-card {
            position: relative;
            background: rgba(255, 255, 255, 0.35);
            backdrop-filter: blur(20px);
            -webkit-backdrop-filter: blur(20px);
            border: 1px solid rgba(255, 255, 255, 0.2);
            border-radius: 1.5rem;
            transition: all 0.5s cubic-bezier(0.25, 0.46, 0.45, 0.94);
            box-shadow: 0 8px 32px 0 rgba(0, 0, 0, 0.1);
            overflow: hidden;
            opacity: 0;
            transform: translateY(50px);
            transition: opacity 0.5s ease-out, transform 0.5s cubic-bezier(0.25, 0.46, 0.45, 0.94);
        }
        
        .topic-card.visible {
            opacity: 1;
            transform: translateY(0);
        }
        
        .topic-card:nth-child(1) { transition-delay: 0.05s; }
        .topic-card:nth-child(2) { transition-delay: 0.1s; }
        .topic-card:nth-child(3) { transition-delay: 0.15s; }
        .topic-card:nth-child(4) { transition-delay: 0.2s; }
        .topic-card:nth-child(5) { transition-delay: 0.25s; }


        .topic-card::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            border-radius: inherit;
            pointer-events: none;
            box-shadow: inset 0 0 0 1.5px rgba(255, 255, 255, 0.6);
            transition: box-shadow 0.4s ease;
            z-index: 1;
        }
        
        .topic-card:hover::before { 
            box-shadow: inset 0 0 0 2px rgba(255, 255, 255, 0.8);
        }
        
        .topic-card > div {
            position: relative;
            z-index: 2;
        }

        .topic-card:hover { 
            transform: translateY(-5px);
            border-color: rgba(255, 255, 255, 0.3); 
        }
        
        .topic-card .summary { 
            color: var(--text-primary);
            text-shadow: none;
            font-size: 1.125rem; 
            font-weight: 600; 
            padding: 1.5rem; 
            cursor: pointer; 
            outline: none; 
            display: flex; 
            justify-content: space-between; 
            align-items: center; 
        }
        .topic-card .summary::after { 
            content: '+'; 
            font-size: 1.5rem; 
            font-weight: 400; 
            color: var(--text-secondary);
            text-shadow: none;
            transition: transform 0.3s ease-in-out; 
        }
        .topic-card.is-open > .summary::after { transform: rotate(45deg); }
        .topic-card.is-open > .summary { 
            border-bottom: 1px solid rgba(255, 255, 255, 0.2); 
        }
        
        .topic-content-wrapper {
            max-height: 0;
            overflow: hidden;
            transition: max-height 0.5s ease-in-out;
        }
        .topic-content { 
            padding: 1.5rem; 
            font-size: 0.95rem; 
            color: var(--text-secondary);
            text-shadow: none;
        }

        .image-bubble {
            position: relative;
            background: rgba(255, 255, 255, 0.2);
            border-radius: 1.25rem;
            padding: 0.75rem;
            margin-top: 1rem;
            backdrop-filter: blur(10px);
            -webkit-backdrop-filter: blur(10px);
            cursor: pointer;
            transition: all 0.3s ease;
            box-shadow: 0 4px 15px rgba(0,0,0,0.05);
        }
        .image-bubble:hover {
            transform: scale(1.03);
            box-shadow: 0 6px 20px rgba(0,0,0,0.1);
        }
        .image-bubble svg {
            width: 100%;
            height: auto;
            border-radius: 0.75rem;
            display: block;
        }
        
        #fundamentos .topic-card.is-open {
            box-shadow: 0 8px 25px rgba(0,0,0,0.08), inset 0 0 0 2px var(--equilibrio-border);
        }
        #trocas .topic-card.is-open {
            box-shadow: 0 8px 25px rgba(0,0,0,0.08), inset 0 0 0 2px var(--extracelular-border);
        }
        #desequilibrios .topic-card.is-open {
            box-shadow: 0 8px 25px rgba(0,0,0,0.08), inset 0 0 0 2px var(--intracelular-border);
        }
        
        #fundamentos .topic-card.is-open:hover {
            box-shadow: 0 8px 25px rgba(0,0,0,0.1), inset 0 0 0 2px rgba(132, 204, 22, 0.6);
        }
        #trocas .topic-card.is-open:hover {
            box-shadow: 0 8px 25px rgba(0,0,0,0.1), inset 0 0 0 2px rgba(59, 130, 246, 0.6);
        }
        #desequilibrios .topic-card.is-open:hover {
            box-shadow: 0 8px 25px rgba(0,0,0,0.1), inset 0 0 0 2px rgba(244, 63, 94, 0.6);
        }
        
        .term { 
            text-decoration: none; 
            cursor: pointer; 
            font-weight: 500;
            padding: 4px 10px;
            border-radius: 0.6rem;
            transition: all 0.2s ease-in-out;
            text-shadow: none;
        }
        #fundamentos .term { background-color: var(--equilibrio-glow); color: #4d7c0f; }
        #trocas .term { background-color: var(--extracelular-glow); color: #1d4ed8; }
        #desequilibrios .term { background-color: var(--intracelular-glow); color: #9d174d; }
        .term:hover { 
            filter: brightness(1.15); 
        }

        /* Modal Styling */
        #modal-overlay {
            position: fixed;
            top: 0; left: 0;
            width: 100%; height: 100%;
            background-color: rgba(248, 250, 252, 0.5);
            backdrop-filter: blur(8px);
            -webkit-backdrop-filter: blur(8px);
            display: flex;
            justify-content: center;
            align-items: center;
            padding: 1rem;
            opacity: 0;
            visibility: hidden;
            transition: opacity 0.4s ease, visibility 0s linear 0.4s;
            z-index: 1000;
        }
        #modal-overlay.visible {
            opacity: 1;
            visibility: visible;
            transition: opacity 0.4s ease;
        }
        
        #modal-content {
            background: rgba(255, 255, 255, 0.55); 
            backdrop-filter: blur(20px);
            -webkit-backdrop-filter: blur(20px);
            border: 1px solid rgba(255, 255, 255, 0.3);
            color: var(--text-primary);
            box-shadow: 0 25px 50px -12px rgba(0,0,0,0.15);
            border-radius: 2rem;
            position: relative;
            width: 90%;
            max-width: 500px;
            transform: scale(0.95);
            transition: transform 0.4s ease;
            overflow: hidden; 
        }
        
        #modal-content.image-modal {
             max-width: 650px;
        }
        
        #modal-content::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            border-radius: inherit;
            pointer-events: none;
            box-shadow: inset 0 0 0 1.5px rgba(255, 255, 255, 0.6);
            z-index: 1;
        }

        #modal-overlay.visible #modal-content { 
            transform: scale(1);
        }
        
        #modal-content.theme-fundamentos { box-shadow: 0 25px 50px -12px rgba(0,0,0,0.15), inset 0 0 0 2px var(--equilibrio-border); }
        #modal-content.theme-trocas { box-shadow: 0 25px 50px -12px rgba(0,0,0,0.15), inset 0 0 0 2px var(--extracelular-border); }
        #modal-content.theme-desequilibrios { box-shadow: 0 25px 50px -12px rgba(0,0,0,0.15), inset 0 0 0 2px var(--intracelular-border); }
        
        #modal-header, #modal-description {
            position: relative;
            z-index: 2;
        }

        #modal-header {
            border-bottom: 1px solid rgba(255, 255, 255, 0.2);
            background: transparent;
            text-align: center;
            padding: 1.5rem 3.5rem;
        }
        
        #modal-title { 
            font-size: 1.75rem; 
            font-weight: 700; 
            text-shadow: none;
        }
        #modal-header.theme-fundamentos #modal-title { color: var(--equilibrio-color); }
        #modal-header.theme-trocas #modal-title { color: var(--extracelular-color); }
        #modal-header.theme-desequilibrios #modal-title { color: var(--intracelular-color); }
        
        #modal-description { font-size: 1.05rem; color: var(--text-secondary); line-height: 1.7; padding: 1.5rem 2rem 2rem 2rem; }
        
        #modal-image-container {
            padding: 1.5rem;
            display: flex;
            justify-content: center;
        }
        #modal-image-container svg {
            width: 100%;
            max-width: 450px;
            height: auto;
            border-radius: 1rem;
        }

        #modal-close-btn {
            position: absolute;
            top: 1rem; right: 1rem;
            background: rgba(0,0,0,0.05);
            border: none;
            border-radius: 50%;
            width: 2.5rem; height: 2.5rem;
            cursor: pointer; 
            transition: background-color 0.2s ease, transform 0.2s ease;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.2rem;
            color: var(--text-secondary);
            z-index: 3;
        }
        #modal-close-btn:hover { background: rgba(0,0,0,0.1); transform: scale(1.1); }
        
        .footer-signature { text-align: center; padding: 4rem 1rem; background-color: transparent; color: #94a3b8; }
        ul { list-style-position: inside; padding-left: 0.5rem;}
        li { margin-bottom: 0.5rem; }

        /* == Quiz Styles == */
        #quiz-section {
             background: rgba(255, 255, 255, 0.2);
             backdrop-filter: blur(15px);
             -webkit-backdrop-filter: blur(15px);
             border-top: 1px solid rgba(255, 255, 255, 0.3);
             padding-bottom: 4rem;
        }

        .quiz-container {
            max-width: 800px;
            width: 100%;
            background: rgba(255, 255, 255, 0.5);
            border: 1px solid rgba(255, 255, 255, 0.2);
            border-radius: 2rem;
            padding: 2.5rem;
            box-shadow: 0 10px 40px rgba(0,0,0,0.1);
            position: relative;
        }
        
        /* New Progress Bar Styles */
        #progress-bar-container {
            width: 100%;
            max-width: 800px;
            background-color: rgba(255, 255, 255, 0.4);
            border-radius: 9999px;
            padding: 0.5rem;
            margin-bottom: 2rem;
            box-shadow: 0 4px 15px rgba(0,0,0,0.05);
            border: 1px solid rgba(255, 255, 255, 0.5);
        }
        #progress-bar-fill {
            height: 1.5rem;
            background: linear-gradient(90deg, #84cc16, #3b82f6);
            border-radius: 9999px;
            transition: width 0.5s ease-in-out;
            text-align: center;
            color: white;
            font-weight: 600;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 0.875rem;
        }
        #progress-label {
            text-align: center;
            margin-top: 0.75rem;
            font-weight: 500;
            color: var(--text-secondary);
        }

        /* Question Counter Display */
        #question-counter-display {
            position: absolute;
            top: 1.5rem;
            right: 1.5rem;
            width: 44px;
            height: 44px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 0.8rem;
            font-weight: 700;
            color: white;
            transition: all 0.3s ease;
        }
        #question-counter-display.facil-bg {
            background-color: #22c55e; /* green-500 */
        }
        #question-counter-display.media-bg {
            background-color: #f59e0b; /* amber-500 */
        }
        #question-counter-display.dificil-bg {
            background-color: #ef4444; /* red-500 */
        }

        /* Timer Display Styles */
        #timer-display {
            position: absolute;
            top: 1.5rem;
            left: 1.5rem;
            width: 44px;
            height: 44px;
            border-radius: 50%;
            background-color: rgba(255,255,255,0.4);
            border: 3px solid var(--text-secondary);
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1rem;
            font-weight: 700;
            color: var(--text-primary);
            transition: all 0.3s ease;
        }
        #timer-display.warning {
            border-color: #f59e0b;
            color: #b45309;
            transform: scale(1.1);
        }
        #timer-display.danger {
            border-color: #ef4444;
            color: #991b1b;
            transform: scale(1.1);
            animation: pulse 1s infinite;
        }
        @keyframes pulse {
            0% { box-shadow: 0 0 0 0 rgba(239, 68, 68, 0.5); }
            70% { box-shadow: 0 0 0 10px rgba(239, 68, 68, 0); }
            100% { box-shadow: 0 0 0 0 rgba(239, 68, 68, 0); }
        }
        
        #modal-description { font-size: 1.05rem; color: var(--text-secondary); line-height: 1.7; padding: 0 2rem 2rem 2rem; }
        
        #quiz-question {
            font-size: 1.5rem;
            font-weight: 600;
            color: var(--text-primary);
            margin-bottom: 2rem;
            padding: 0 60px;
            text-align: center;
        }

        #quiz-options {
            list-style: none;
            padding: 0;
            display: flex;
            flex-direction: column;
            gap: 1rem;
        }

        .quiz-option {
            background-color: rgba(255,255,255,0.7);
            border: 1px solid rgba(0,0,0,0.05);
            border-radius: 1rem;
            padding: 1.25rem;
            font-size: 1.1rem;
            cursor: pointer;
            transition: transform 0.2s ease-out, box-shadow 0.2s ease-out, background-color 0.2s ease-out;
            box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.07), 0 2px 4px -2px rgba(0, 0, 0, 0.07);
            will-change: transform, box-shadow;
        }

        .quiz-option:hover {
            transform: translateY(-3px);
            background-color: white;
            box-shadow: 0 10px 15px -3px rgba(0, 0, 0, 0.1), 0 4px 6px -4px rgba(0, 0, 0, 0.1);
        }
        
        .quiz-option.disabled {
            cursor: not-allowed;
            opacity: 0.7;
        }
        
        .quiz-option.correct-answer {
            border-color: #22c55e;
            background-color: #f0fdf4;
            color: #15803d;
            font-weight: 600;
        }
        
        .quiz-option.incorrect-answer {
            border-color: #ef4444;
            background-color: #fef2f2;
            color: #b91c1c;
            font-weight: 600;
        }

        #quiz-start-btn, #restart-quiz-btn {
            background: rgba(255, 255, 255, 0.4);
            backdrop-filter: blur(10px);
            -webkit-backdrop-filter: blur(10px);
            font-weight: 700;
            padding: 1rem 2.5rem;
            border-radius: 1rem;
            font-size: 1.2rem;
            border: 1px solid rgba(255, 255, 255, 0.5);
            cursor: pointer;
            transition: all 0.2s ease-in-out;
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.1);
        }
        
        #quiz-start-btn {
            color: var(--text-primary);
        }
        #restart-quiz-btn {
            color: var(--extracelular-color);
             margin-top: 2rem;
        }

        #quiz-start-btn:hover, #restart-quiz-btn:hover {
            transform: scale(1.05);
            background: rgba(255, 255, 255, 0.6);
            box-shadow: 0 6px 20px rgba(0, 0, 0, 0.15);
        }
        
        #quiz-results {
             text-align: center;
        }
        
        #quiz-results h3 {
             font-size: 2rem;
             font-weight: 700;
             margin-bottom: 1.5rem;
        }

        #quiz-percentage {
            font-size: 3.5rem;
            font-weight: 800;
            color: var(--text-primary);
            margin-bottom: 2rem;
            width: 150px;
            height: 150px;
            background: rgba(255, 255, 255, 0.4);
            backdrop-filter: blur(10px);
            -webkit-backdrop-filter: blur(10px);
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            margin-left: auto;
            margin-right: auto;
            border: 1px solid rgba(255, 255, 255, 0.5);
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.1);
        }
        
        .results-stats {
            display: flex;
            justify-content: center;
            gap: 1.5rem;
            margin-bottom: 2.5rem;
            font-size: 1.1rem;
        }
        
        .stat-correct, .stat-incorrect {
            font-weight: 600;
            color: var(--text-primary);
            padding: 0.5rem 1.25rem;
            border-radius: 9999px;
            transition: all 0.2s ease-in-out;
        }

        .stat-correct {
            background-color: rgba(34, 197, 94, 0.25); 
        }

        .stat-incorrect {
            background-color: rgba(239, 68, 68, 0.25);
        }
        
        #missed-topics-list {
            display: flex;
            flex-wrap: wrap;
            justify-content: center;
            gap: 0.75rem;
            list-style: none;
            padding: 0;
            margin-top: 1rem;
        }

        .missed-topic-bubble {
            background-color: #f1f5f9;
            color: var(--text-secondary);
            padding: 0.5rem 1rem;
            border-radius: 9999px;
            font-size: 0.9rem;
            font-weight: 500;
            transition: all 0.2s ease-in-out;
            cursor: pointer;
            border: 2px solid transparent;
        }

        .missed-topic-bubble:hover {
            background-color: #e2e8f0;
            transform: translateY(-2px);
            box-shadow: 0 4px 10px rgba(0,0,0,0.05);
        }

        .missed-topic-bubble.visited-topic {
            border-color: #22c55e;
            background-color: #f0fdf4;
            color: #166534;
        }

    </style>
</head>
<body>
    <div class="background-container">
        <div class="light-bubble b1"></div>
        <div class="light-bubble b2"></div>
        <div class="light-bubble b3"></div>
        <div class="dynamic-bg-glow" id="bg-fundamentos"></div>
        <div class="dynamic-bg-glow" id="bg-trocas"></div>
        <div class="dynamic-bg-glow" id="bg-desequilibrios"></div>
    </div>

    <!-- Hero Section -->
    <section id="hero" class="section-container">
        <div class="section-header-card">
            <h1>A Dinâmica dos Líquidos Corporais</h1>
            <p class="mt-4">Uma exploração interativa dos compartimentos de líquidos do corpo, as forças que governam suas trocas e as consequências de seus desequilíbrios.</p>
        </div>
    </section>
    
    <!-- Fundamentals Section -->
    <section id="fundamentos" class="section-container">
        <div class="section-header-card">
            <h2 class="section-title">Fundamentos dos Compartimentos</h2>
            <p class="section-subtitle">Nosso corpo é um vasto oceano dividido em compartimentos. Entender o líquido intracelular e extracelular é a chave para a fisiologia e a homeostase.</p>
        </div>
        <div class="topics-grid">
            <div class="topic-card" id="topic-lic-e-lec">
                <div class="summary">LIC vs. LEC</div>
                <div class="topic-content-wrapper">
                    <div class="topic-content">
                        <ul>
                            <li>O corpo humano é composto por cerca de 60% de água, dividida em dois grandes compartimentos.</li>
                            <li><span class="term" data-description="É o líquido contido dentro das células. Corresponde a cerca de 2/3 (aprox. 28 litros) do total de água corporal e é rico em potássio (K+), magnésio (Mg++) e íons fosfato.">Líquido Intracelular (LIC)</span>: O oceano dentro das células.</li>
                            <li><span class="term" data-description="É todo o líquido fora das células. Corresponde a 1/3 (aprox. 14 litros) da água corporal e é rico em sódio (Na+), cloreto (Cl-) e bicarbonato (HCO3-).">Líquido Extracelular (LEC)</span>: O ambiente que banha as células.</li>
                             <li>O LEC é subdividido em <span class="term" data-description="O líquido que preenche os espaços entre as células (aprox. 11 litros).">líquido intersticial</span> e <span class="term" data-description="A parte líquida do sangue (aprox. 3 litros).">plasma sanguíneo</span>.</li>
                        </ul>
                    </div>
                </div>
            </div>
            <div class="topic-card" id="topic-composicao-ionica">
                <div class="summary">Composição Iônica</div>
                <div class="topic-content-wrapper">
                    <div class="topic-content">
                        <ul>
                            <li>A composição de íons é drasticamente diferente entre LIC e LEC, mantida por bombas iônicas como a Na+/K+ ATPase.</li>
                            <li>No <span class="term" data-description="Principal cátion é o Potássio (K+). Principais ânions são fosfatos e proteínas.">LIC</span>, predomina o K⁺.</li>
                            <li>No <span class="term" data-description="Principal cátion é o Sódio (Na+). Principais ânions são Cloreto (Cl-) e Bicarbonato (HCO3-).">LEC</span>, predomina o Na⁺.</li>
                            <li>As proteínas, por serem grandes e carregadas negativamente, são mais concentradas no plasma e no LIC, e influenciam a distribuição de outros íons pelo <span class="term" data-description="Um efeito que descreve a distribuição desigual de íons permeáveis através de uma membrana quando há um íon impermeável (como a proteína) de um lado. Isso faz com que a concentração de cátions seja ligeiramente maior no plasma do que no interstício.">Efeito Donnan</span>.</li>
                        </ul>
                        <div class="image-bubble" id="svg-composicao-ionica" data-img-svg="true" data-img-alt="Gráfico de Composição Iônica" data-img-description="Este gráfico compara as concentrações dos principais íons nos compartimentos extracelular (rosa e azul) e intracelular (laranja, amarelo, verde). Note a predominância de Sódio (Na+) no LEC e de Potássio (K+) no LIC, uma diferença crucial mantida ativamente pelas células.">
                            <svg viewBox="0 0 350 400" xmlns="http://www.w3.org/2000/svg" class="text-sm font-sans" fill="#475569">
                                <title>Gráfico de Composição Iônica LIC vs LEC</title>
                                <!-- Axes and Labels -->
                                <line x1="10" y1="200" x2="340" y2="200" stroke="#475569" stroke-width="1.5"></line>
                                <line x1="175" y1="10" x2="175" y2="390" stroke="#475569" stroke-width="1.5" stroke-dasharray="4"></line>
                                <g>
                                    <rect x="55" y="12" width="70" height="25" rx="5" fill="rgba(255,255,255,0.8)"></rect>
                                    <text x="90" y="28" text-anchor="middle" font-weight="600" fill="#1e293b">Cátions</text>
                                </g>
                                <g>
                                    <rect x="225" y="12" width="70" height="25" rx="5" fill="rgba(255,255,255,0.8)"></rect>
                                    <text x="260" y="28" text-anchor="middle" font-weight="600" fill="#1e293b">Ânions</text>
                                </g>
                                <text x="330" y="150" text-anchor="middle" writing-mode="vertical-rl" font-weight="600" fill="#1e293b">EXTRACELULAR</text>
                                <text x="330" y="290" text-anchor="middle" writing-mode="vertical-rl" font-weight="600" fill="#1e293b">INTRACELULAR</text>
                                <text x="15" y="55" text-anchor="end">150</text>
                                <text x="15" y="105" text-anchor="end">100</text>
                                <text x="15" y="155" text-anchor="end">50</text>
                                <text x="15" y="205" text-anchor="end">0</text>
                                <text x="15" y="255" text-anchor="end">50</text>
                                <text x="15" y="305" text-anchor="end">100</text>
                                <text x="15" y="355" text-anchor="end">150</text>
                                <text x="5" y="205" text-anchor="middle" writing-mode="vertical-rl" font-size="0.8em">mEq/l</text>
                                <!-- Extracellular Bars -->
                                <rect x="30" y="58" width="40" height="142" fill="#fca5a5" stroke="#ef4444" stroke-width="1"></rect>
                                <g>
                                    <rect x="35" y="182" width="30" height="18" rx="4" fill="rgba(255,255,255,0.85)"></rect>
                                    <text x="50" y="195" text-anchor="middle">Na⁺</text>
                                </g>
                                <rect x="120" y="188" width="20" height="12" fill="#f9a8d4" stroke="#f472b6" stroke-width="1"></rect>
                                <g>
                                    <rect x="110" y="171" width="40" height="18" rx="4" fill="rgba(255,255,255,0.85)"></rect>
                                    <text x="130" y="184" text-anchor="middle">Ca⁺⁺</text>
                                </g>
                                <rect x="190" y="88" width="40" height="112" fill="#bfdbfe" stroke="#60a5fa" stroke-width="1"></rect>
                                <g>
                                    <rect x="198" y="182" width="24" height="18" rx="4" fill="rgba(255,255,255,0.85)"></rect>
                                    <text x="210" y="195" text-anchor="middle">Cl⁻</text>
                                </g>
                                <rect x="240" y="167" width="30" height="33" fill="#fca5a5" stroke="#ef4444" stroke-width="1"></rect>
                                <g>
                                    <rect x="235" y="182" width="40" height="18" rx="4" fill="rgba(255,255,255,0.85)"></rect>
                                    <text x="255" y="195" text-anchor="middle">HCO₃⁻</text>
                                </g>
                                <rect x="280" y="180" width="30" height="20" fill="#bbf7d0" stroke="#4ade80" stroke-width="1"></rect>
                                <g>
                                    <rect x="265" y="162" width="60" height="18" rx="4" fill="rgba(255,255,255,0.85)"></rect>
                                    <text x="295" y="175" text-anchor="middle">Proteínas</text>
                                </g>
                                <!-- Intracellular Bars -->
                                <rect x="80" y="200" width="30" height="145" fill="#fde047" stroke="#facc15" stroke-width="1"></rect>
                                <g>
                                    <rect x="83" y="202" width="24" height="18" rx="4" fill="rgba(255,255,255,0.85)"></rect>
                                    <text x="95" y="215" text-anchor="middle">K⁺</text>
                                </g>
                                <rect x="120" y="200" width="20" height="30" fill="#99f6e4" stroke="#5eead4" stroke-width="1"></rect>
                                <g>
                                    <rect x="110" y="222" width="40" height="18" rx="4" fill="rgba(255,255,255,0.85)"></rect>
                                    <text x="130" y="235" text-anchor="middle">Mg⁺⁺</text>
                                </g>
                                <rect x="190" y="200" width="40" height="130" fill="#fef9c3" stroke="#fde047" stroke-width="1"></rect>
                                <g>
                                    <rect x="185" y="205" width="50" height="30" rx="5" fill="rgba(255,255,255,0.8)"></rect>
                                    <text x="210" y="218" text-anchor="middle" font-size="0.8em">PO₄⁻ e</text>
                                    <text x="210" y="229" text-anchor="middle" font-size="0.8em">ânions org.</text>
                                </g>
                                <rect x="280" y="200" width="30" height="55" fill="#bbf7d0" stroke="#4ade80" stroke-width="1"></rect>
                                <g>
                                    <rect x="265" y="247" width="60" height="18" rx="4" fill="rgba(255,255,255,0.85)"></rect>
                                    <text x="295" y="260" text-anchor="middle">Proteínas</text>
                                </g>
                            </svg>
                        </div>
                    </div>
                </div>
            </div>
            <div class="topic-card" id="topic-hematocrito">
                <div class="summary">Volume Sanguíneo e Hematócrito</div>
                <div class="topic-content-wrapper">
                    <div class="topic-content">
                        <ul>
                            <li>O sangue contém tanto LEC (plasma) quanto LIC (dentro das hemácias).</li>
                            <li><span class="term" data-description="É a fração do volume sanguíneo composta por hemácias (glóbulos vermelhos). É um indicador importante da viscosidade do sangue e da capacidade de transporte de oxigênio.">Hematócrito</span>: Percentual de hemácias no sangue.</li>
                            <li>Valores normais: Homens (40-45%), Mulheres (36-42%).</li>
                            <li>Na <span class="term" data-description="Condição de baixo hematócrito, que pode indicar sangramento, deficiências nutricionais ou outras doenças.">anemia grave</span>, o hematócrito pode cair para 10%. Na <span class="term" data-description="Condição de alto hematócrito, que aumenta a viscosidade do sangue e o risco de trombose.">policitemia</span>, pode chegar a 65%.</li>
                        </ul>
                    </div>
                </div>
            </div>
             <div class="topic-card" id="topic-balanco-de-massa">
                <div class="summary">A Lei do Balanço de Massa</div>
                <div class="topic-content-wrapper">
                    <div class="topic-content">
                        <ul>
                            <li>Este princípio fundamental afirma que a quantidade de uma substância no corpo permanece constante se a entrada for igual à saída.</li>
                            <li><span class="term" data-description="Inclui a ingestão de alimentos e líquidos, e a produção metabólica de água.">Ganhos</span>: O que entra no corpo.</li>
                            <li><span class="term" data-description="Inclui a excreção pelos rins (urina), pulmões (respiração), pele (suor) e fezes.">Perdas</span>: O que sai do corpo.</li>
                            <li>Se Ganhos > Perdas, ocorre acúmulo da substância.</li>
                            <li>Se Perdas > Ganhos, ocorre uma perda líquida da substância. Manter esse equilíbrio é essencial para a <span class="term" data-description="A tendência do corpo de manter um ambiente interno estável e relativamente constante.">homeostase</span>.</li>
                        </ul>
                    </div>
                </div>
            </div>
        </div>
    </section>

    <!-- Capillary Exchange Section -->
    <section id="trocas" class="section-container">
         <div class="section-header-card">
            <h2 class="section-title">A Troca nos Capilares</h2>
            <p class="section-subtitle">As fronteiras entre os compartimentos são dinâmicas. Nos capilares, um delicado balanço de forças determina o movimento de fluidos, essencial para nutrir os tecidos.</p>
        </div>
        <div class="topics-grid">
            <div class="topic-card" id="topic-forcas-de-starling">
                <div class="summary">As Forças de Starling</div>
                <div class="topic-content-wrapper">
                    <div class="topic-content">
                        <ul>
                            <li class="flex justify-between items-center bg-blue-50 p-2 rounded-lg mb-2">
                                <span><span class="term" data-description="A pressão exercida pelo sangue contra a parede do capilar. Tende a 'empurrar' o líquido para fora do capilar. (Pc)">Pressão Hidrostática Capilar (Pc)</span>: Força de saída.</span>
                                <span class="text-blue-600 font-bold flex items-center gap-1">Saída
                                    <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-arrow-up-right-circle" viewBox="0 0 16 16">
                                        <path fill-rule="evenodd" d="M1 8a7 7 0 1 0 14 0A7 7 0 0 0 1 8m15 0A8 8 0 1 1 0 8a8 8 0 0 1 16 0M5.854 10.854a.5.5 0 0 0 .708 0L12 5.707V8.5a.5.5 0 0 0 1 0v-4a.5.5 0 0 0-.5-.5H8.5a.5.5 0 0 0 0 1h2.793L5.146 10.146a.5.5 0 0 0 0 .708"/>
                                    </svg>
                                </span>
                            </li>
                            <li class="flex justify-between items-center bg-rose-50 p-2 rounded-lg mb-2">
                                <span><span class="term" data-description="A pressão do líquido no espaço intersticial. Tende a 'empurrar' o líquido para dentro do capilar. (Pi)">Pressão Hidrostática Intersticial (Pi)</span>: Força de entrada.</span>
                                <span class="text-rose-600 font-bold flex items-center gap-1">Entrada
                                    <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-arrow-down-left-circle" viewBox="0 0 16 16">
                                        <path fill-rule="evenodd" d="M1 8a7 7 0 1 0 14 0A7 7 0 0 0 1 8m15 0A8 8 0 1 1 0 8a8 8 0 0 1 16 0M10.854 5.146a.5.5 0 0 0 0 .708L5.707 11H8.5a.5.5 0 0 0 0-1H4.5a.5.5 0 0 0-.5.5v4a.5.5 0 0 0 1 0V8.207l5.146-5.147a.5.5 0 0 0 0-.708"/>
                                    </svg>
                                </span>
                            </li>
                            <li class="flex justify-between items-center bg-rose-50 p-2 rounded-lg mb-2">
                                <span><span class="term" data-description="A 'força osmótica' gerada pelas proteínas (principalmente albumina) no plasma. Tende a 'puxar' o líquido para dentro do capilar. (Πp)">Pressão Coloidosmótica Plasmática (Πp)</span>: Força de entrada.</span>
                                 <span class="text-rose-600 font-bold flex items-center gap-1">Entrada
                                    <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-arrow-down-left-circle" viewBox="0 0 16 16">
                                        <path fill-rule="evenodd" d="M1 8a7 7 0 1 0 14 0A7 7 0 0 0 1 8m15 0A8 8 0 1 1 0 8a8 8 0 0 1 16 0M10.854 5.146a.5.5 0 0 0 0 .708L5.707 11H8.5a.5.5 0 0 0 0-1H4.5a.5.5 0 0 0-.5.5v4a.5.5 0 0 0 1 0V8.207l5.146-5.147a.5.5 0 0 0 0-.708"/>
                                    </svg>
                                </span>
                            </li>
                            <li class="flex justify-between items-center bg-blue-50 p-2 rounded-lg">
                                <span><span class="term" data-description="A 'força osmótica' gerada por proteínas que escaparam para o interstício. Tende a 'puxar' o líquido para fora do capilar. (Πi)">Pressão Coloidosmótica Intersticial (Πi)</span>: Força de saída.</span>
                                 <span class="text-blue-600 font-bold flex items-center gap-1">Saída
                                    <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-arrow-up-right-circle" viewBox="0 0 16 16">
                                        <path fill-rule="evenodd" d="M1 8a7 7 0 1 0 14 0A7 7 0 0 0 1 8m15 0A8 8 0 1 1 0 8a8 8 0 0 1 16 0M5.854 10.854a.5.5 0 0 0 .708 0L12 5.707V8.5a.5.5 0 0 0 1 0v-4a.5.5 0 0 0-.5-.5H8.5a.5.5 0 0 0 0 1h2.793L5.146 10.146a.5.5 0 0 0 0 .708"/>
                                    </svg>
                                </span>
                            </li>
                        </ul>
                        <div class="image-bubble" id="svg-forcas-starling" data-img-svg="true" data-img-alt="Diagrama das Forças de Starling" data-img-description="Esta imagem ilustra as quatro Forças de Starling em um capilar. As setas indicam a direção de cada força: a Pressão Hidrostática Capilar (Pc) e a Coloidosmótica Intersticial (Πi) empurram o fluido para fora, enquanto a Pressão Coloidosmótica Plasmática (Πp) e a Hidrostática Intersticial (Pi) o trazem para dentro. O balanço entre elas determina se ocorrerá filtração ou absorção.">
                            <svg viewBox="0 0 600 260" xmlns="http://www.w3.org/2000/svg" class="text-sm font-sans" fill="#1e293b">
                                <title>Diagrama das Forças de Starling</title>
                        
                                <!-- Defs for arrowheads -->
                                <defs>
                                    <marker id="arrow-down" viewBox="0 0 10 10" refX="5" refY="10" markerWidth="5" markerHeight="5" orient="auto-start-reverse">
                                        <path d="M 0 0 L 5 10 L 10 0 z" fill="black"></path>
                                    </marker>
                                    <marker id="arrow-up" viewBox="0 0 10 10" refX="5" refY="0" markerWidth="5" markerHeight="5" orient="auto-start-reverse">
                                        <path d="M 0 10 L 5 0 L 10 10 z" fill="black"></path>
                                    </marker>
                                </defs>
                        
                                <!-- Capillary vessel -->
                                <path d="M 25 80 H 575 V 180 H 25 Z" fill="#fca5a5" stroke="#b91c1c" stroke-width="1.5"></path>
                                <rect x="25" y="80" width="550" height="100" fill="none" stroke="#b91c1c" stroke-width="2" stroke-dasharray="5 5"></rect>
                                
                                <!-- Text and Arrows -->
                                <g text-anchor="middle" font-weight="500">
                                    <!-- Pressão Capilar (Pc) -->
                                    <text x="180" y="55">Pressão capilar</text>
                                    <text x="180" y="70">(Pc)</text>
                                    <line x1="180" y1="75" x2="180" y2="105" stroke="black" stroke-width="2" marker-end="url(#arrow-down)"></line>
                        
                                    <!-- Pressão do Líquido Intersticial (Pi) -->
                                    <text x="180" y="210">Pressão do líquido</text>
                                    <text x="180" y="225">intersticial (Pi)</text>
                                    <line x1="180" y1="200" x2="180" y2="160" stroke="black" stroke-width="2" marker-end="url(#arrow-up)"></line>
                        
                                    <!-- Pressão Coloidosmótica Plasmática (Πp) -->
                                    <text x="420" y="55">Pressão coloidosmótica</text>
                                    <text x="420" y="70">plasmática (Πp)</text>
                                    <line x1="420" y1="105" x2="420" y2="75" stroke="black" stroke-width="2" marker-end="url(#arrow-up)"></line>
                        
                                    <!-- Pressão Coloidosmótica do Líquido Intersticial (Πi) -->
                                    <text x="420" y="210">Pressão coloidosmótica</text>
                                    <text x="420" y="225">do líquido intersticial (Πi)</text>
                                    <line x1="420" y1="160" x2="420" y2="200" stroke="black" stroke-width="2" marker-end="url(#arrow-down)"></line>
                                </g>
                            </svg>
                        </div>
                    </div>
                </div>
            </div>
            <div class="topic-card" id="topic-filtracao-e-absorcao">
                <div class="summary">Filtração e Absorção</div>
                <div class="topic-content-wrapper">
                    <div class="topic-content">
                        <ul>
                            <li>O balanço das Forças de Starling determina o movimento resultante do fluido.</li>
                            <li><span class="term" data-description="Ocorre quando a soma das forças que empurram o líquido para fora é maior que a soma das forças que o puxam para dentro. Predomina na extremidade arterial do capilar, onde a Pc é mais alta.">Filtração</span>: Saída de líquido do capilar.</li>
                            <li><span class="term" data-description="Ocorre quando a soma das forças que puxam o líquido para dentro é maior. Predomina na extremidade venosa, onde a Pc é mais baixa.">Absorção</span>: Entrada de líquido no capilar.</li>
                            <li>A Pressão Efetiva de Filtração (PEF) é calculada como: <strong>PEF = Pc - Pi - Πp + Πi</strong>.</li>
                        </ul>
                    </div>
                </div>
            </div>
            <div class="topic-card" id="topic-extremos-capilares">
                <div class="summary">Extremidade Arterial vs. Venosa</div>
                <div class="topic-content-wrapper">
                    <div class="topic-content">
                        <ul>
                            <li><span class="term" data-description="Nesta ponta, a Pressão Hidrostática Capilar (Pc) é alta (ex: 35 mmHg), superando a Pressão Coloidosmótica Plasmática (Πp). O resultado é uma força efetiva para fora, causando filtração de líquido para o interstício.">Extremidade Arterial</span>: Domínio da Filtração.</li>
                            <li><span class="term" data-description="Aqui, com a perda de fluido, a Pc cai significativamente (ex: 15 mmHg), tornando-se menor que a Πp. O resultado é uma força efetiva para dentro, promovendo a reabsorção do líquido intersticial de volta para o capilar.">Extremidade Venosa</span>: Domínio da Reabsorção.</li>
                            <li>Este gradiente de pressão ao longo do capilar garante a troca contínua de nutrientes e resíduos.</li>
                        </ul>
                    </div>
                </div>
            </div>
            <div class="topic-card" id="topic-sistema-linfatico">
                <div class="summary">O Papel do Sistema Linfático</div>
                <div class="topic-content-wrapper">
                    <div class="topic-content">
                        <ul>
                            <li>Normalmente, a filtração é ligeiramente maior que a absorção. O excesso de líquido e proteínas no interstício é coletado pelo sistema linfático.</li>
                            <li>O <span class="term" data-description="Uma rede de vasos que atua como uma via acessória para retornar o excesso de fluido intersticial (agora chamado de linfa) e proteínas de volta à circulação sanguínea.">sistema linfático</span> é crucial para prevenir o acúmulo de líquido nos tecidos (edema).</li>
                            <li>O fluxo linfático normal é de cerca de 2 a 3 litros por dia.</li>
                            <li>Uma falha neste sistema leva ao <span class="term" data-description="Um tipo de edema causado pela obstrução ou remoção dos vasos linfáticos, resultando em acúmulo de líquido rico em proteínas no interstício.">linfedema</span>.</li>
                        </ul>
                    </div>
                </div>
            </div>
        </div>
    </section>

    <!-- Fluid Imbalances Section -->
    <section id="desequilibrios" class="section-container">
        <div class="section-header-card">
            <h2 class="section-title">Desequilíbrios Hídricos</h2>
            <p class="section-subtitle">Quando o delicado balanço dos líquidos é perturbado, podem surgir condições como edema, desidratação e distúrbios eletrolíticos, afetando a função de todo o organismo.</p>
        </div>
        <div class="topics-grid">
            <div class="topic-card" id="topic-edema-extracelular">
                <div class="summary">Causas do Edema Extracelular</div>
                <div class="topic-content-wrapper">
                    <div class="topic-content">
                        <ul>
                            <li>Ocorre por aumento da filtração ou falha na drenagem. As principais causas são:</li>
                            <li><strong>Aumento da Pc:</strong> <span class="term" data-description="O coração fraco não bombeia o sangue eficientemente, aumentando a pressão venosa e, consequentemente, a pressão hidrostática capilar, o que força o líquido para o interstício.">Insuficiência cardíaca</span> e obstrução venosa.</li>
                            <li><strong>Diminuição da Πp:</strong> <span class="term" data-description="O fígado doente produz menos albumina, a principal proteína plasmática. Com menos proteína no sangue, a força que retém líquido dentro dos vasos diminui.">Cirrose hepática</span> ou <span class="term" data-description="Os rins danificados perdem grandes quantidades de albumina na urina, diminuindo a pressão coloidosmótica do plasma.">síndrome nefrótica</span>.</li>
                            <li><strong>Aumento da Permeabilidade:</strong> Em reações inflamatórias ou queimaduras, os capilares se tornam mais 'vazados'.</li>
                            <li><strong>Obstrução Linfática:</strong> Bloqueio da drenagem do excesso de líquido, como em infecções (filariose) ou após cirurgias.</li>
                        </ul>
                    </div>
                </div>
            </div>
            <div class="topic-card" id="topic-edema-intracelular">
                <div class="summary">Causas do Edema Intracelular</div>
                <div class="topic-content-wrapper">
                    <div class="topic-content">
                        <ul>
                            <li>Ocorre quando as células incham por entrada excessiva de água. As duas causas principais são:</li>
                            <li><span class="term" data-description="A baixa concentração de sódio no LEC torna este meio hipotônico em relação ao LIC. A água então se move por osmose para dentro das células para equilibrar as concentrações, causando o inchaço celular.">Hiponatremia</span>: Baixo sódio no LEC.</li>
                            <li><span class="term" data-description="Se o metabolismo celular está prejudicado (ex: por falta de oxigênio), a bomba de sódio e potássio pode falhar. O sódio se acumula dentro da célula, tornando o LIC hipertônico e puxando água para dentro.">Depressão Metabólica</span>: Falha das bombas iônicas.</li>
                            <li>Este tipo de edema é particularmente perigoso para o cérebro, onde o inchaço é limitado pelo crânio.</li>
                        </ul>
                    </div>
                </div>
            </div>
            <div class="topic-card" id="topic-osmolaridade">
                <div class="summary">Balanço Hídrico e Osmolaridade</div>
                <div class="topic-content-wrapper">
                    <div class="topic-content">
                        <ul>
                            <li>A água se move livremente entre os compartimentos para equilibrar a <span class="term" data-description="É a medida da concentração total de solutos em uma solução. Em condições normais, a osmolaridade do LIC e do LEC é a mesma (isotônicos), cerca de 280-300 mOsm/L.">osmolaridade</span>.</li>
                            <li>Adição de solução <span class="term" data-description="Uma solução com a mesma osmolaridade que os fluidos corporais. A infusão de soro isotônico aumenta apenas o volume do LEC, sem alterar o volume do LIC.">isotônica</span>: Aumenta o volume do LEC.</li>
                            <li>Adição de solução <span class="term" data-description="Uma solução menos concentrada. A infusão de soro hipotônico faz com que a água entre nas células, aumentando tanto o volume do LEC quanto do LIC.">hipotônica</span>: Aumenta o volume do LEC e do LIC.</li>
                            <li>Adição de solução <span class="term" data-description="Uma solução mais concentrada. A infusão de soro hipertônico 'puxa' a água de dentro das células, aumentando o volume do LEC e diminuindo o do LIC.">hipertônica</span>: Aumenta o volume do LEC e diminui o do LIC.</li>
                        </ul>
                         <div class="image-bubble" id="svg-darrow-yannet" data-img-svg="true" data-img-alt="Diagramas de Darrow-Yannet" data-img-description="Esses diagramas mostram como os volumes do LIC (rosa) e LEC (amarelo) e a osmolaridade total mudam em diferentes cenários. O estado normal é a referência. A adição de soluções isotônicas, hipertônicas ou hipotônicas altera os volumes e/ou a osmolaridade de maneiras distintas, demonstrando os princípios da osmose entre os compartimentos.">
                           <svg viewBox="0 0 500 600" xmlns="http://www.w3.org/2000/svg" class="font-sans">
                                <title>Diagramas de Darrow-Yannet</title>
                                <defs>
                                    <style>.label{font-size:12px; font-weight:600; text-anchor: middle;} .axis-label{font-size:10px; text-anchor: end;}</style>
                                </defs>

                                <!-- Diagram 1: Normal State -->
                                <g transform="translate(0, 0)">
                                    <text x="120" y="20" class="label">Estado Normal</text>
                                    <path d="M40 30 V 280 H 200 V 30" stroke="black" stroke-width="1.5" fill="none"/>
                                    <rect x="40" y="30" width="90" height="200" fill="#f43f5e" />
                                    <rect x="130" y="30" width="70" height="200" fill="#fef08a" />
                                    <text x="35" y="80" class="axis-label">300</text>
                                    <line x1="40" y1="80" x2="200" y2="80" stroke="gray" stroke-dasharray="2" stroke-width="0.5"/>
                                    <text transform="rotate(-90 15 155)" x="15" y="155" class="axis-label" text-anchor="middle">Osmolaridade</text>
                                    <text x="120" y="295" class="axis-label" text-anchor="middle">Volume (L)</text>
                                    <text x="85" y="245" font-size="10px">LIC</text>
                                    <text x="165" y="245" font-size="10px">LEC</text>
                                </g>

                                <!-- Diagram 2: Isotonic Addition -->
                                <g transform="translate(250, 0)">
                                    <text x="120" y="20" class="label">Adição de Sol. Isotônica</text>
                                    <path d="M40 30 V 280 H 220 V 30" stroke="black" stroke-width="1.5" fill="none" stroke-dasharray="4 2"/>
                                    <rect x="40" y="80" width="90" height="150" fill="#f43f5e" />
                                    <rect x="130" y="80" width="90" height="150" fill="#fef08a" />
                                </g>

                                <!-- Diagram 3: Hypertonic Addition -->
                                <g transform="translate(0, 300)">
                                    <text x="120" y="20" class="label">Adição de Sol. Hipertônica</text>
                                    <path d="M40 30 V 280 H 210 V 30" stroke="black" stroke-width="1.5" fill="none" stroke-dasharray="4 2"/>
                                    <rect x="40" y="30" width="80" height="200" fill="#f43f5e" />
                                    <rect x="120" y="30" width="90" height="200" fill="#fef08a" />
                                </g>

                                <!-- Diagram 4: Hypotonic Addition -->
                                <g transform="translate(250, 300)">
                                    <text x="120" y="20" class="label">Adição de Sol. Hipotônica</text>
                                    <path d="M40 30 V 280 H 220 V 30" stroke="black" stroke-width="1.5" fill="none" stroke-dasharray="4 2"/>
                                    <rect x="40" y="100" width="100" height="130" fill="#f43f5e" />
                                    <rect x="140" y="100" width="80" height="130" fill="#fef08a" />
                                </g>
                           </svg>
                        </div>
                    </div>
                </div>
            </div>
            <div class="topic-card" id="topic-hipo-e-hipernatremia">
                <div class="summary">Hiponatremia e Hipernatremia</div>
                <div class="topic-content-wrapper">
                    <div class="topic-content">
                        <ul>
                            <li>A concentração de Sódio (Na⁺) no plasma é o principal indicador da osmolaridade do LEC.</li>
                            <li><span class="term" data-description="Baixa concentração de sódio no plasma (<135 mEq/L). Pode ser causada por perda de sódio (vômito, diarreia) ou excesso de água. Causa edema celular, especialmente perigoso no cérebro.">Hiponatremia</span>: Baixo Sódio.</li>
                            <li><span class="term" data-description="Alta concentração de sódio no plasma (>145 mEq/L). Pode ser causada por perda de água (desidratação, diabetes insípido) ou excesso de sódio. Causa retração (encolhimento) celular.">Hipernatremia</span>: Alto Sódio.</li>
                            <li>Ambas as condições podem levar a graves disfunções neurológicas devido às alterações no volume das células cerebrais.</li>
                        </ul>
                    </div>
                </div>
            </div>
            <div class="topic-card" id="topic-riscos-correcao-hiponatremia">
                <div class="summary">Riscos da Correção Rápida</div>
                <div class="topic-content-wrapper">
                    <div class="topic-content">
                        <ul>
                            <li>Um ponto clínico crucial no tratamento da hiponatremia.</li>
                            <li>Na <span class="term" data-description="Quando a hiponatremia se instala lentamente (dias), as células cerebrais se adaptam expulsando solutos (K+, Na+, solutos orgânicos) para diminuir sua osmolaridade interna e evitar o inchaço excessivo.">hiponatremia crônica</span>, o cérebro se adapta.</li>
                            <li>Se a concentração de sódio no plasma for corrigida muito rapidamente com uma solução hipertônica, o LEC se torna subitamente hipertônico.</li>
                            <li>As células cerebrais, que já perderam seus solutos, não conseguem recuperá-los a tempo. A água é "puxada" violentamente para fora delas.</li>
                            <li>Isso causa uma desidratação celular abrupta, que pode levar a uma grave lesão neurológica chamada <span class="term" data-description="Uma condição neurológica devastadora causada pela correção excessivamente rápida da hiponatremia, que leva à destruição da bainha de mielina dos neurônios.">síndrome de desmielinização osmótica</span>.</li>
                        </ul>
                    </div>
                </div>
            </div>
        </div>
    </section>

    <!-- Quiz Section -->
    <section id="quiz-section" class="section-container">
        <div class="section-header-card">
            <h2 class="section-title">Teste seu Conhecimento</h2>
            <p class="section-subtitle">Vamos ver o que você aprendeu! Responda às perguntas a seguir para testar sua compreensão sobre os líquidos corporais.</p>
        </div>

        <div id="quiz-area" class="w-full max-w-3xl flex flex-col items-center">
             <!-- Progress Bar -->
            <div id="progress-bar-container">
                <div id="progress-bar-fill" style="width: 0%;">0%</div>
            </div>
            <div id="progress-label">Progresso: 0 de 60 questões dominadas</div>

            <div id="quiz-container" class="quiz-container hidden">
                <div id="timer-display">30</div>
                <div id="question-counter-display"></div>
                <h3 id="quiz-question"></h3>
                <ul id="quiz-options"></ul>
            </div>
            <div id="quiz-results" class="quiz-container hidden">
                <h3>Quiz Finalizado!</h3>
                <div id="quiz-percentage">100%</div>
                <div class="results-stats">
                    <span id="stat-correct-count" class="stat-correct"></span>
                    <span id="stat-incorrect-count" class="stat-incorrect"></span>
                </div>
                <h4 class="text-lg font-semibold mt-6 mb-2 text-slate-700">Tópicos para revisar:</h4>
                <ul id="missed-topics-list"></ul>
                 <button id="restart-quiz-btn">Novo Quiz</button>
            </div>
            <button id="quiz-start-btn">Começar Quiz</button>
        </div>
    </section>

    <!-- Footer -->
    <footer class="footer-signature">
        <p>Feito por Rafael Chaves Sebe.</p>
    </footer>

    <!-- Modal Structure -->
    <div id="modal-overlay" class="fixed inset-0">
        <div id="modal-content" class="relative">
             <button id="modal-close-btn" class="absolute top-4 right-4 z-20">&times;</button>
            <div id="modal-header" class="relative hidden">
                <h3 id="modal-title"></h3>
            </div>
            <div id="modal-image-container" class="hidden">
                 <!-- SVG will be injected here by JS -->
            </div>
            <p id="modal-description"></p>
        </div>
    </div>

    <script>
        document.addEventListener('DOMContentLoaded', () => {
            // Observer for section background changes
            const bgObserver = new IntersectionObserver((entries) => {
                entries.forEach(entry => {
                    const glowId = `bg-${entry.target.id}`;
                    const glowEl = document.getElementById(glowId);
                    if (glowEl) {
                        if (entry.isIntersecting) {
                            glowEl.style.opacity = '0.25';
                        } else {
                            glowEl.style.opacity = '0';
                        }
                    }
                });
            }, { threshold: 0.4 }); 

            document.querySelectorAll('#fundamentos, #trocas, #desequilibrios').forEach(section => {
                bgObserver.observe(section);
            });

            // Observer for card animations
            const cardObserver = new IntersectionObserver((entries, observer) => {
                entries.forEach(entry => {
                    if (entry.isIntersecting) {
                        entry.target.classList.add('visible');
                    } else if (entry.boundingClientRect.top > 0) {
                        entry.target.classList.remove('visible');
                    }
                });
            }, {
                threshold: 0.01
            });
            document.querySelectorAll('.topic-card, .section-header-card').forEach(card => {
                cardObserver.observe(card);
            });

            // Modal logic
            const modalOverlay = document.getElementById('modal-overlay');
            const modalContent = document.getElementById('modal-content');
            const modalHeader = document.getElementById('modal-header');
            const modalTitle = document.getElementById('modal-title');
            const modalDescription = document.getElementById('modal-description');
            const modalCloseBtn = document.getElementById('modal-close-btn');
            const modalImageContainer = document.getElementById('modal-image-container');

            function openModal() {
                modalOverlay.classList.add('visible');
                document.body.style.overflow = 'hidden';
            }

            const closeModal = () => {
                modalOverlay.classList.remove('visible');
                setTimeout(() => {
                    if (!modalOverlay.classList.contains('visible')) {
                         document.body.style.overflow = '';
                         // Limpa o conteúdo do gráfico ao fechar para evitar que o antigo apareça
                         modalImageContainer.innerHTML = '';
                    }
                }, 400); 
            };

            // Event Listeners for Terms
            document.querySelectorAll('.term').forEach(term => {
                term.addEventListener('click', (event) => {
                    event.preventDefault();
                    const title = term.textContent;
                    const description = term.getAttribute('data-description');
                    const parentSection = term.closest('section');
                    let theme = 'fundamentos'; 
                    if (parentSection && parentSection.id) {
                       if (parentSection.id === 'trocas') theme = 'trocas';
                       else if (parentSection.id === 'desequilibrios') theme = 'desequilibrios';
                    }
                    
                    modalContent.classList.remove('image-modal');
                    modalHeader.classList.remove('hidden');
                    modalImageContainer.classList.add('hidden');
                    
                    modalTitle.textContent = title;
                    modalDescription.textContent = description;
                    
                    modalContent.className = 'relative'; 
                    modalHeader.className = '';
                    modalContent.classList.add(`theme-${theme}`);
                    modalHeader.classList.add(`theme-${theme}`);
                    
                    openModal();
                });
            });

             // Event Listeners for Images/SVGs
            document.querySelectorAll('.image-bubble').forEach(bubble => {
                bubble.addEventListener('click', () => {
                    const isSvg = bubble.dataset.imgSvg === 'true';
                    const description = bubble.dataset.imgDescription;
                    const parentSection = bubble.closest('section');
                     let theme = 'fundamentos'; 
                    if (parentSection && parentSection.id) {
                       if (parentSection.id === 'trocas') theme = 'trocas';
                       else if (parentSection.id === 'desequilibrios') theme = 'desequilibrios';
                    }

                    modalContent.classList.add('image-modal');
                    modalHeader.classList.add('hidden');
                    modalImageContainer.classList.remove('hidden');
                    
                    if (isSvg) {
                       const svgElement = bubble.querySelector('svg');
                       modalImageContainer.innerHTML = svgElement.outerHTML;
                    } 
                    
                    modalDescription.textContent = description;

                    modalContent.className = 'relative image-modal'; 
                    modalContent.classList.add(`theme-${theme}`);

                    openModal();
                });
            });

            modalCloseBtn.addEventListener('click', closeModal);
            modalOverlay.addEventListener('click', (event) => {
                if (event.target === modalOverlay) closeModal();
            });
            
            // Accordion logic
            document.querySelectorAll('.topic-card .summary').forEach(summary => {
                summary.addEventListener('click', (e) => {
                    const card = e.currentTarget.parentElement;
                    toggleAccordion(card);
                });
            });

            function toggleAccordion(cardToToggle) {
                const contentWrapper = cardToToggle.querySelector('.topic-content-wrapper');
                const isOpen = cardToToggle.classList.contains('is-open');

                const parentGrid = cardToToggle.closest('.topics-grid');
                parentGrid.querySelectorAll('.topic-card.is-open').forEach(openCard => {
                    if (openCard !== cardToToggle) {
                        const otherContentWrapper = openCard.querySelector('.topic-content-wrapper');
                        otherContentWrapper.style.maxHeight = '0px';
                        openCard.classList.remove('is-open');
                    }
                });

                if (isOpen) {
                    contentWrapper.style.maxHeight = '0px';
                    cardToToggle.classList.remove('is-open');
                } else {
                    const content = cardToToggle.querySelector('.topic-content');
                    contentWrapper.style.maxHeight = content.scrollHeight + 'px';
                    cardToToggle.classList.add('is-open');
                }
            }
            
            // ===================================
            // == QUIZ LOGIC V3 (com Timer e Progresso)
            // ===================================

            const questionBank = [
                // --- FÁCIL: 12 Teóricas + 8 Gráficas = 20 ---
                { id: 1, difficulty: 'Fácil', question: "Qual compartimento contém a maior parte da água corporal total (cerca de 2/3)?", topic: "LIC vs. LEC", options: ["Líquido intersticial", "Plasma sanguíneo", "Líquido extracelular (LEC)", "Líquido intracelular (LIC)"], correctAnswer: 3 },
                { id: 2, difficulty: 'Fácil', question: "O Líquido Extracelular (LEC) é composto principalmente por quais dois fluidos?", topic: "LIC vs. LEC", options: ["Plasma e linfa", "Líquido intersticial e plasma", "Apenas plasma", "Apenas líquido dentro das células"], correctAnswer: 1 },
                { id: 3, difficulty: 'Fácil', question: "Qual é o principal CÁTION (íon positivo) encontrado no Líquido Extracelular (LEC)?", topic: "Composição Iônica", options: ["Potássio (K+)", "Sódio (Na+)", "Cálcio (Ca++)", "Magnésio (Mg++)"], correctAnswer: 1 },
                { id: 4, difficulty: 'Fácil', question: "Qual é o principal CÁTION (íon positivo) encontrado no Líquido Intracelular (LIC)?", topic: "Composição Iônica", options: ["Sódio (Na+)", "Cálcio (Ca++)", "Potássio (K+)", "Hidrogênio (H+)"], correctAnswer: 2 },
                { id: 5, difficulty: 'Fácil', question: "O que o hematócrito mede?", topic: "Volume Sanguíneo e Hematócrito", options: ["A porcentagem de plasma no sangue", "A porcentagem de hemácias no volume total de sangue", "A concentração de proteínas no plasma", "O volume total de sangue no corpo"], correctAnswer: 1 },
                { id: 6, difficulty: 'Fácil', question: "Na troca capilar, qual processo predomina na extremidade ARTERIAL?", topic: "Extremidade Arterial vs. Venosa", options: ["Absorção", "Equilíbrio", "Filtração", "Nenhum dos dois"], correctAnswer: 2 },
                { id: 7, difficulty: 'Fácil', question: "Qual das Forças de Starling é gerada principalmente pelas proteínas no plasma, como a albumina?", topic: "As Forças de Starling", options: ["Pressão hidrostática capilar (Pc)", "Pressão coloidosmótica plasmática (Πp)", "Pressão hidrostática intersticial (Pi)", "Pressão coloidosmótica intersticial (Πi)"], correctAnswer: 1 },
                { id: 8, difficulty: 'Fácil', question: "O acúmulo anormal de líquido no espaço intersticial é chamado de:", topic: "Causas do Edema Extracelular", options: ["Hematócrito", "Homeostase", "Edema", "Policitemia"], correctAnswer: 2 },
                { id: 9, difficulty: 'Fácil', question: "Qual condição é caracterizada por uma baixa concentração de sódio no plasma (<135 mEq/L)?", topic: "Hiponatremia e Hipernatremia", options: ["Hipernatremia", "Hipocalemia", "Hiponatremia", "Hipercalemia"], correctAnswer: 2 },
                { id: 10, difficulty: 'Fácil', question: "De acordo com a Lei do Balanço de Massa, o que acontece se a ingestão de uma substância for igual à sua excreção?", topic: "A Lei do Balanço de Massa", options: ["Ocorre acúmulo da substância", "Ocorre perda líquida da substância", "A quantidade da substância no corpo permanece constante", "O metabolismo da substância para"], correctAnswer: 2 },
                { id: 11, difficulty: 'Fácil', question: "O que acontece com o volume do LEC ao se administrar uma solução salina ISOTÔNICA?", topic: "Balanço Hídrico e Osmolaridade", options: ["Aumenta", "Diminui", "Não se altera", "Aumenta e depois diminui"], correctAnswer: 0 },
                { id: 12, difficulty: 'Fácil', question: "O que acontece com as células (volume do LIC) quando uma solução HIPERTÔNICA é adicionada ao LEC?", topic: "Balanço Hídrico e Osmolaridade", options: ["Elas incham (aumentam de volume)", "Elas encolhem (diminuem de volume)", "Seu volume não muda", "Elas se rompem"], correctAnswer: 1 },
                { id: 13, difficulty: 'Fácil', isGraphic: true, question: "Observando o gráfico de composição iônica, qual ânion (íon negativo) está em maior concentração no LEC?", topic: "Composição Iônica", options: ["Proteínas", "HCO₃⁻", "PO₄⁻", "Cl⁻"], correctAnswer: 3, svgId: "svg-composicao-ionica" },
                { id: 14, difficulty: 'Fácil', isGraphic: true, question: "No diagrama das Forças de Starling, a seta 'Pc' representa uma força que tende a...", topic: "As Forças de Starling", options: ["Puxar líquido para dentro do capilar", "Empurrar líquido para fora do capilar", "Não ter efeito sobre o líquido", "Manter as proteínas no capilar"], correctAnswer: 1, svgId: "svg-forcas-starling" },
                { id: 15, difficulty: 'Fácil', isGraphic: true, question: "Qual diagrama de Darrow-Yannet representa o efeito da infusão de soro fisiológico (NaCl isotônico)?", topic: "Balanço Hídrico e Osmolaridade", options: ["Adição de Sol. Isotônica", "Adição de Sol. Hipertônica", "Adição de Sol. Hipotônica", "Estado Normal"], correctAnswer: 0, svgId: "svg-darrow-yannet" },
                { id: 16, difficulty: 'Fácil', isGraphic: true, question: "No gráfico de composição, a barra do K⁺ é muito maior no compartimento intracelular do que no extracelular. O que isso indica?", topic: "Composição Iônica", options: ["O K⁺ não existe fora da célula", "A célula concentra ativamente o K⁺ em seu interior", "O K⁺ vaza livremente para fora", "O Na⁺ e o K⁺ têm concentrações iguais"], correctAnswer: 1, svgId: "svg-composicao-ionica" },
                { id: 17, difficulty: 'Fácil', isGraphic: true, question: "No diagrama de Darrow-Yannet, o que acontece com a osmolaridade geral do corpo após a adição de uma solução HIPOTÔNICA?", topic: "Balanço Hídrico e Osmolaridade", options: ["Aumenta", "Permanece a mesma", "Diminui", "Zera"], correctAnswer: 2, svgId: "svg-darrow-yannet" },
                { id: 18, difficulty: 'Fácil', isGraphic: true, question: "Analisando o diagrama das Forças de Starling, qual força é oposta à Pressão Hidrostática Capilar (Pc)?", topic: "As Forças de Starling", options: ["Pressão Coloidosmótica Plasmática (Πp)", "Pressão Coloidosmótica Intersticial (Πi)", "Pressão Hidrostática Intersticial (Pi)", "Nenhuma das anteriores"], correctAnswer: 2, svgId: "svg-forcas-starling" },
                { id: 19, difficulty: 'Fácil', isGraphic: true, question: "Qual diagrama de Darrow-Yannet mostra uma redução no volume do LIC e um aumento no volume do LEC?", topic: "Balanço Hídrico e Osmolaridade", options: ["Adição de Sol. Isotônica", "Adição de Sol. Hipertônica", "Adição de Sol. Hipotônica", "Estado Normal"], correctAnswer: 1, svgId: "svg-darrow-yannet" },
                { id: 20, difficulty: 'Fácil', isGraphic: true, question: "O gráfico de composição mostra uma pequena quantidade de proteínas no plasma que está quase ausente no interstício. Qual Força de Starling essa diferença gera?", topic: "As Forças de Starling", options: ["Pc", "Pi", "Πp", "Πi"], correctAnswer: 2, svgId: "svg-composicao-ionica" },

                // --- MÉDIA: 14 Teóricas + 6 Gráficas = 20 ---
                { id: 21, difficulty: 'Média', question: "Um paciente com cirrose hepática tem dificuldade em produzir albumina. Como isso afeta as Forças de Starling?", topic: "Causas do Edema Extracelular", options: ["Aumenta a Pc", "Diminui a Πp, favorecendo a filtração", "Aumenta a Πp, favorecendo a absorção", "Diminui a Pi"], correctAnswer: 1 },
                { id: 22, difficulty: 'Média', question: "O que acontece com o líquido que é filtrado nos capilares mas não é reabsorvido?", topic: "O Papel do Sistema Linfático", options: ["Ele é absorvido pelas células dos tecidos", "Ele retorna à circulação através do sistema linfático", "Ele se acumula indefinidamente, sempre causando edema", "Ele é destruído por macrófagos"], correctAnswer: 1 },
                { id: 23, difficulty: 'Média', question: "Por que a filtração predomina na extremidade arterial e a absorção na extremidade venosa dos capilares?", topic: "Extremidade Arterial vs. Venosa", options: ["Porque a Πp é maior na extremidade arterial", "Porque a Pc é maior na extremidade arterial e diminui ao longo do capilar", "Porque os vasos linfáticos só drenam a extremidade venosa", "Porque a permeabilidade do capilar muda"], correctAnswer: 1 },
                { id: 24, difficulty: 'Média', question: "Qual das seguintes condições levaria a um aumento da Pressão Hidrostática Capilar (Pc) e, consequentemente, ao edema?", topic: "Causas do Edema Extracelular", options: ["Desidratação", "Hemorragia", "Insuficiência cardíaca congestiva", "Produção excessiva de albumina"], correctAnswer: 2 },
                { id: 25, difficulty: 'Média', question: "O 'Efeito Donnan' explica por que a concentração de cátions é ligeiramente maior no plasma em comparação com o líquido intersticial. Qual componente do plasma é o principal responsável por esse efeito?", topic: "Composição Iônica", options: ["Sódio (Na+)", "Glicose", "Proteínas carregadas negativamente", "Bicarbonato (HCO3-)"], correctAnswer: 2 },
                { id: 26, difficulty: 'Média', question: "Um paciente com sudorese excessiva (perda de líquido hipotônico) e sem reposição hídrica desenvolverá qual distúrbio?", topic: "Hiponatremia e Hipernatremia", options: ["Hiponatremia por excesso de água", "Hipernatremia por perda de água", "Edema intracelular", "Volume do LEC normal"], correctAnswer: 1 },
                { id: 27, difficulty: 'Média', question: "Qual é a consequência imediata da hiponatremia no volume das células cerebrais?", topic: "Causas do Edema Intracelular", options: ["Encolhimento (redução de volume)", "Inchaço (aumento de volume)", "Nenhuma alteração de volume", "Morte celular imediata"], correctAnswer: 1 },
                { id: 28, difficulty: 'Média', question: "Se uma pessoa beber uma grande quantidade de água pura (líquido hipotônico), o que acontecerá com os volumes de seus compartimentos?", topic: "Balanço Hídrico e Osmolaridade", options: ["Apenas o LEC aumentará", "O LEC diminuirá e o LIC aumentará", "O LEC e o LIC aumentarão de volume", "Apenas o LIC aumentará"], correctAnswer: 2 },
                { id: 29, difficulty: 'Média', question: "Uma obstrução dos vasos linfáticos (linfedema) leva ao acúmulo de qual substância no interstício, piorando o edema?", topic: "O Papel do Sistema Linfático", options: ["Glicose", "Sódio", "Proteínas", "Hemácias"], correctAnswer: 2 },
                { id: 30, difficulty: 'Média', question: "Uma falha na bomba de Na+/K+ devido à falta de ATP (depressão metabólica) causa edema intracelular por qual mecanismo?", topic: "Causas do Edema Intracelular", options: ["Aumenta o Na+ no LEC", "Aumenta o K+ no LEC", "Aumenta o Na+ no LIC, puxando água para dentro", "Diminui o Na+ no LIC, empurrando água para fora"], correctAnswer: 2 },
                { id: 31, difficulty: 'Média', question: "Por que um paciente com policitemia (hematócrito muito alto) tem um risco aumentado de trombose?", topic: "Volume Sanguíneo e Hematócrito", options: ["O sangue fica menos viscoso", "Há poucas hemácias para transportar oxigênio", "O sangue fica mais viscoso, dificultando o fluxo", "O volume de plasma aumenta"], correctAnswer: 2 },
                { id: 32, difficulty: 'Média', question: "Qual é a principal razão para não se corrigir a hiponatremia crônica de forma rápida?", topic: "Riscos da Correção Rápida", options: ["Risco de sobrecarga de volume e edema pulmonar", "Risco de lesão renal aguda", "Risco de síndrome de desmielinização osmótica", "Risco de hipoglicemia severa"], correctAnswer: 2 },
                { id: 33, difficulty: 'Média', question: "A secreção excessiva de Aldosterona causa retenção de sódio. Qual seria o efeito secundário no volume do LEC?", topic: "Hiponatremia e Hipernatremia", options: ["Diminuição, pois o sódio é excretado", "Nenhum, pois a água não segue o sódio", "Aumento, pois a retenção de sódio leva à retenção de água", "O volume do LIC aumentaria mais"], correctAnswer: 2 },
                { id: 34, difficulty: 'Média', question: "Qual a fórmula correta da Pressão Efetiva de Filtração (PEF)?", topic: "Filtração e Absorção", options: ["PEF = Pc + Pi + Πp + Πi", "PEF = Pc - Pi - Πp + Πi", "PEF = Πp - Pc", "PEF = Pc + Πi - Pi"], correctAnswer: 1 },
                { id: 35, difficulty: 'Média', isGraphic: true, question: "No diagrama de Darrow-Yannet, após a adição de uma solução hipertônica, por que a osmolaridade de ambos os compartimentos aumenta?", topic: "Balanço Hídrico e Osmolaridade", options: ["Porque a água se move do LIC para o LEC", "Porque solutos são adicionados ao LEC e a água se move do LIC para o LEC para equilibrar", "Porque a célula produz mais solutos", "Porque os rins excretam água"], correctAnswer: 1, svgId: "svg-darrow-yannet" },
                { id: 36, difficulty: 'Média', isGraphic: true, question: "Se a Pc na extremidade arterial for 35 mmHg, a Pi for 0 mmHg, a Πp for 25 mmHg e a Πi for 3 mmHg, qual será a pressão efetiva de filtração?", topic: "Filtração e Absorção", options: ["13 mmHg (filtração)", "7 mmHg (absorção)", "63 mmHg (filtração)", "0 mmHg (equilíbrio)"], correctAnswer: 0 },
                { id: 37, difficulty: 'Média', isGraphic: true, question: "O gráfico de Darrow-Yannet para 'Adição de Sol. Hipotônica' mostra um aumento maior no volume do LIC do que no LEC. Por quê?", topic: "Balanço Hídrico e Osmolaridade", options: ["Porque o LEC não pode expandir", "Porque a água se move para o compartimento com maior osmolaridade inicial (LIC) para atingir o equilíbrio", "Porque a maior parte da água inicial já está no LIC", "Porque a membrana celular é impermeável à água"], correctAnswer: 2, svgId: "svg-darrow-yannet" },
                { id: 38, difficulty: 'Média', isGraphic: true, question: "Analisando o gráfico de composição iônica, a grande diferença na concentração de Na+ e K+ entre LIC e LEC é mantida por qual mecanismo ativo?", topic: "Composição Iônica", options: ["Difusão simples", "Canais de vazamento", "Bomba de Na+/K+ ATPase", "Osmose"], correctAnswer: 2, svgId: "svg-composicao-ionica" },
                { id: 39, difficulty: 'Média', isGraphic: true, question: "Em qual cenário do diagrama de Darrow-Yannet o volume do LIC permanece inalterado?", topic: "Balanço Hídrico e Osmolaridade", options: ["Adição de Sol. Isotônica", "Adição de Sol. Hipertônica", "Adição de Sol. Hipotônica", "Nenhum deles"], correctAnswer: 0, svgId: "svg-darrow-yannet" },
                { id: 40, difficulty: 'Média', isGraphic: true, question: "Se a Πp (Pressão Coloidosmótica Plasmática) caísse para 15 mmHg, o que aconteceria com a tendência de filtração e absorção?", topic: "As Forças de Starling", options: ["A filtração aumentaria e a absorção diminuiria", "A filtração diminuiria e a absorção aumentaria", "Ambas aumentariam", "Não haveria mudança"], correctAnswer: 0 },
                
                // --- DIFÍCIL: 14 Teóricas + 6 Gráficas = 20 ---
                { id: 41, difficulty: 'Difícil', question: "Na hiponatremia crônica, as células cerebrais se adaptam. Como elas fazem isso para minimizar o edema?", topic: "Riscos da Correção Rápida", options: ["Aumentando a produção de proteínas", "Transportando ativamente água para fora", "Extrudando solutos (K+, Na+, osmólitos orgânicos) para diminuir sua osmolaridade interna", "Fechando todos os canais de água (aquaporinas)"], correctAnswer: 2 },
                { id: 42, difficulty: 'Difícil', question: "Um paciente com diabetes insípido não produz ADH, levando à perda de grandes volumes de urina diluída. Qual distúrbio eletrolítico é esperado?", topic: "Hiponatremia e Hipernatremia", options: ["Hipernatremia e desidratação", "Hiponatremia e hiper-hidratação", "Hipocalemia e acidose", "Hipercalcemia e alcalose"], correctAnswer: 0 },
                { id: 43, difficulty: 'Difícil', question: "Se a pressão hidrostática do líquido intersticial (Pi) se tornasse positiva (ex: +5 mmHg) devido a um edema severo, como isso afetaria a dinâmica dos fluidos capilares?", topic: "Filtração e Absorção", options: ["Aumentaria a filtração", "Opor-se-ia à filtração e favoreceria a absorção", "Não teria efeito sobre a filtração", "Aumentaria a Πp"], correctAnswer: 1 },
                { id: 44, difficulty: 'Difícil', question: "Por que a concentração de Cl- é ligeiramente menor no plasma do que no líquido intersticial, apesar de ambos serem parte do LEC?", topic: "Composição Iônica", options: ["O Cl- é ativamente bombeado para o interstício", "Devido ao Efeito Donnan, onde as proteínas negativas no plasma repelem o Cl-", "O Cl- é consumido no plasma", "O interstício tem mais canais de Cl-"], correctAnswer: 1 },
                { id: 45, difficulty: 'Difícil', question: "Um corredor de maratona bebe apenas água pura em excesso durante uma corrida. Qual condição de risco ele pode desenvolver?", topic: "Hiponatremia e Hipernatremia", options: ["Hipernatremia por desidratação", "Hiponatremia por diluição", "Aumento do hematócrito", "Edema extracelular"], correctAnswer: 1 },
                { id: 46, difficulty: 'Difícil', question: "Qual é o principal fator que limita a correção rápida da hipernatremia com soluções hipotônicas?", topic: "Hiponatremia e Hipernatremia", options: ["Risco de sobrecarga cardíaca", "Risco de edema cerebral, pois a água entra rapidamente nas células cerebrais", "Risco de lesão renal", "Risco de coagulação sanguínea"], correctAnswer: 1 },
                { id: 47, difficulty: 'Difícil', question: "Qual das seguintes condições NÃO causaria edema por aumento da filtração capilar?", topic: "Causas do Edema Extracelular", options: ["Obstrução de uma veia da perna", "Insuficiência cardíaca direita", "Uma reação alérgica grave (anafilaxia) que aumenta a permeabilidade capilar", "Hemorragia severa"], correctAnswer: 3 },
                { id: 48, difficulty: 'Difícil', question: "Em um paciente com insuficiência renal que não consegue excretar sal, qual seria a sequência de eventos?", topic: "Causas do Edema Extracelular", options: ["Retenção de sal -> retenção de água -> aumento do volume do LEC -> hipertensão e edema", "Perda de sal -> perda de água -> hipotensão", "Retenção de sal -> perda de água -> hipernatremia", "Perda de sal -> retenção de água -> hiponatremia"], correctAnswer: 0 },
                { id: 49, difficulty: 'Difícil', question: "Se a Pressão Efetiva de Filtração na extremidade arterial é +13 mmHg e na venosa é -7 mmHg, o que isso implica sobre o balanço de fluidos?", topic: "Filtração e Absorção", options: ["A absorção é maior que a filtração", "Há um equilíbrio perfeito, sem fluxo resultante", "A filtração é ligeiramente maior que a absorção, necessitando de drenagem linfática", "O capilar está obstruído"], correctAnswer: 2 },
                { id: 50, difficulty: 'Difícil', question: "Um paciente recebe uma infusão de manitol (um açúcar que não atravessa facilmente as membranas celulares). Como isso afetará os compartimentos de fluidos?", topic: "Balanço Hídrico e Osmolaridade", options: ["Causará edema intracelular", "Agirá como uma solução hipotônica", "Aumentará a osmolaridade do LEC e retirará água do LIC, agindo como um diurético osmótico", "Não terá efeito sobre os volumes"], correctAnswer: 2 },
                { id: 51, difficulty: 'Difícil', question: "A síndrome de secreção inapropriada de ADH (SIADH) causa qual distúrbio primário?", topic: "Hiponatremia e Hipernatremia", options: ["Perda de água e hipernatremia", "Retenção de água e hiponatremia dilucional", "Retenção de sal e água", "Perda de sal e água"], correctAnswer: 1 },
                { id: 52, difficulty: 'Difícil', question: "Por que uma pessoa com desnutrição proteica grave (Kwashiorkor) desenvolve ascite (edema abdominal)?", topic: "Causas do Edema Extracelular", options: ["Aumento da Pc devido à insuficiência cardíaca", "Diminuição da Πp devido à falta de produção de albumina", "Obstrução linfática por parasitas", "Aumento da Pi"], correctAnswer: 1 },
                { id: 53, difficulty: 'Difícil', question: "Se o coeficiente de filtração capilar (Kf) dobrasse devido a uma queimadura, qual seria o efeito na formação de edema, mesmo que as pressões permanecessem as mesmas?", topic: "Filtração e Absorção", options: ["A formação de edema diminuiria", "A formação de edema aumentaria significativamente", "Não haveria alteração", "A absorção aumentaria"], correctAnswer: 1 },
                { id: 54, difficulty: 'Difícil', question: "Qual o mecanismo de adaptação que as células cerebrais usam para se proteger do encolhimento na hipernatremia crônica?", topic: "Hiponatremia e Hipernatremia", options: ["Expulsando solutos", "Aumentando a captação ou produção de osmólitos intracelulares", "Aumentando a permeabilidade à água", "Diminuindo o metabolismo"], correctAnswer: 1 },
                { id: 55, difficulty: 'Difícil', isGraphic: true, question: "O diagrama de Darrow-Yannet para 'Adição de Sol. Hipertônica' seria representativo de qual condição clínica?", topic: "Hiponatremia e Hipernatremia", options: ["Beber muita água pura", "Vômitos e diarreia sem reposição", "Tratamento com solução de manitol ou ingestão de água do mar", "Infusão de soro fisiológico"], correctAnswer: 2, svgId: "svg-darrow-yannet" },
                { id: 56, difficulty: 'Difícil', isGraphic: true, question: "Se um paciente desenvolve insuficiência cardíaca, qual força no diagrama de Starling aumentaria cronicamente, causando edema?", topic: "As Forças de Starling", options: ["Πp", "Πi", "Pi", "Pc"], correctAnswer: 3, svgId: "svg-forcas-starling" },
                { id: 57, difficulty: 'Difícil', isGraphic: true, question: "Se o sistema linfático fosse completamente bloqueado, qual força no diagrama de Starling aumentaria progressivamente, piorando o edema?", topic: "As Forças de Starling", options: ["Πp", "Πi (devido ao acúmulo de proteínas no interstício)", "Pc", "Nenhuma, o edema seria apenas de água"], correctAnswer: 1, svgId: "svg-forcas-starling" },
                { id: 58, difficulty: 'Difícil', isGraphic: true, question: "Qual cenário clínico corresponderia ao diagrama de Darrow-Yannet para 'Adição de Sol. Hipotônica'?", topic: "Balanço Hídrico e Osmolaridade", options: ["Desidratação por falta de ingestão de água", "SIADH (secreção inapropriada de ADH)", "Insuficiência adrenal com perda de sal", "Sudorese intensa"], correctAnswer: 1, svgId: "svg-darrow-yannet" },
                { id: 59, difficulty: 'Difícil', isGraphic: true, question: "Observando o gráfico de composição, por que o plasma e o interstício têm composições tão similares, exceto pelas proteínas?", topic: "Composição Iônica", options: ["Porque são o mesmo fluido", "Porque a membrana capilar é livremente permeável à maioria dos pequenos íons, mas não às proteínas", "Porque a bomba de Na+/K+ só funciona no plasma", "É uma coincidência"], correctAnswer: 1, svgId: "svg-composicao-ionica" },
                { id: 60, difficulty: 'Difícil', isGraphic: true, question: "Um paciente com doença renal perde muita proteína na urina. Qual força no diagrama de Starling diminuiria, contribuindo para o edema?", topic: "As Forças de Starling", options: ["Pc", "Πp", "Pi", "Πi"], correctAnswer: 1, svgId: "svg-forcas-starling" },
            ];

            const startBtn = document.getElementById('quiz-start-btn');
            const restartBtn = document.getElementById('restart-quiz-btn');
            const quizContainer = document.getElementById('quiz-container');
            const resultsContainer = document.getElementById('quiz-results');
            const questionEl = document.getElementById('quiz-question');
            const optionsEl = document.getElementById('quiz-options');
            const progressBarFill = document.getElementById('progress-bar-fill');
            const progressLabel = document.getElementById('progress-label');
            const timerDisplay = document.getElementById('timer-display');
            const questionCounterDisplay = document.getElementById('question-counter-display');
            
            let currentQuestionIndex = 0;
            let score = 0;
            let missedTopics = [];
            let activeQuiz = [];
            let correctlyAnsweredIds = [];

            let questionTimer;
            let countdownInterval;
            const TIMER_DURATION = 30; // seconds

            function loadProgress() {
                const savedProgress = localStorage.getItem('liclequiz_correctlyAnsweredIds');
                correctlyAnsweredIds = savedProgress ? JSON.parse(savedProgress) : [];
                updateProgressBar();
            }

            function saveProgress() {
                localStorage.setItem('liclequiz_correctlyAnsweredIds', JSON.stringify(correctlyAnsweredIds));
            }

            function updateProgressBar() {
                const totalQuestions = questionBank.length;
                const answeredCount = correctlyAnsweredIds.length;
                const percentage = totalQuestions > 0 ? Math.round((answeredCount / totalQuestions) * 100) : 0;
                
                progressBarFill.style.width = `${percentage}%`;
                progressBarFill.textContent = `${percentage}%`;
                progressLabel.textContent = `Progresso: ${answeredCount} de ${totalQuestions} questões dominadas`;
            }
            
            function startQuiz() {
                // Filtra as perguntas que o usuário ainda não acertou
                const availableQuestions = questionBank.filter(q => !correctlyAnsweredIds.includes(q.id));
                
                // Se não houver mais perguntas, mostra uma mensagem
                if (availableQuestions.length === 0) {
                     resultsContainer.classList.remove('hidden');
                     quizContainer.classList.add('hidden');
                     startBtn.classList.add('hidden');
                     document.getElementById('quiz-percentage').textContent = '🏆';
                     document.getElementById('stat-correct-count').textContent = 'Parabéns!';
                     document.getElementById('stat-incorrect-count').textContent = 'Você dominou tudo!';
                     document.getElementById('missed-topics-list').innerHTML = '';
                     return;
                }

                // Seleciona 20 perguntas aleatórias do pool disponível
                activeQuiz = [...availableQuestions].sort(() => 0.5 - Math.random()).slice(0, 20);
                
                currentQuestionIndex = 0;
                score = 0;
                missedTopics = [];
                startBtn.classList.add('hidden');
                resultsContainer.classList.add('hidden');
                quizContainer.classList.remove('hidden');
                showQuestion();
            }

            function startTimer() {
                clearTimeout(questionTimer);
                clearInterval(countdownInterval);

                let timeLeft = TIMER_DURATION;
                timerDisplay.textContent = timeLeft;
                timerDisplay.className = 'absolute top-10 left-10 w-11 h-11 rounded-full bg-white/40 border-3 border-slate-600 flex items-center justify-center text-base font-bold text-slate-800 transition-all duration-300 ease-in-out';
                
                countdownInterval = setInterval(() => {
                    timeLeft--;
                    timerDisplay.textContent = timeLeft;
                    if (timeLeft <= 10 && timeLeft > 5) {
                        timerDisplay.classList.add('warning');
                    } else if (timeLeft <= 5) {
                        timerDisplay.classList.add('danger');
                    }
                }, 1000);

                questionTimer = setTimeout(() => {
                    clearInterval(countdownInterval);
                    handleTimeUp();
                }, TIMER_DURATION * 1000);
            }

            function handleTimeUp() {
                 selectAnswer(null); // Pass null to indicate time's up
            }

            function showQuestion() {
                resetState();
                if (currentQuestionIndex >= activeQuiz.length) {
                    showResults();
                    return;
                }
                const questionData = activeQuiz[currentQuestionIndex];

                // Update question counter display and color
                questionCounterDisplay.textContent = `${currentQuestionIndex + 1}/${activeQuiz.length}`;
                questionCounterDisplay.classList.remove('facil-bg', 'media-bg', 'dificil-bg');
                if (questionData.difficulty === 'Fácil') {
                    questionCounterDisplay.classList.add('facil-bg');
                } else if (questionData.difficulty === 'Média') {
                    questionCounterDisplay.classList.add('media-bg');
                } else if (questionData.difficulty === 'Difícil') {
                    questionCounterDisplay.classList.add('dificil-bg');
                }


                // Add SVG if it exists for the question
                if (questionData.isGraphic && questionData.svgId) {
                    const svgContainer = document.getElementById(questionData.svgId);
                    if (svgContainer) {
                        const svgElement = svgContainer.querySelector('svg').cloneNode(true);
                        svgElement.classList.add('quiz-question-svg');
                        svgElement.style.maxWidth = '400px';
                        svgElement.style.margin = '0 auto 1.5rem auto';
                        svgElement.style.backgroundColor = 'rgba(255,255,255,0.4)';
                        svgElement.style.borderRadius = '1rem';
                        svgElement.style.padding = '0.5rem';
                        questionEl.parentNode.insertBefore(svgElement, questionEl);
                    }
                }

                questionEl.textContent = questionData.question;
                
                questionData.options.forEach((option, index) => {
                    const li = document.createElement('li');
                    li.textContent = option;
                    li.classList.add('quiz-option');
                    li.dataset.index = index;
                    li.addEventListener('click', selectAnswer);
                    optionsEl.appendChild(li);
                });
                startTimer();
            }

            function resetState() {
                clearTimeout(questionTimer);
                clearInterval(countdownInterval);
                const existingSvg = quizContainer.querySelector('.quiz-question-svg');
                if (existingSvg) {
                    existingSvg.remove();
                }
                while(optionsEl.firstChild) {
                    optionsEl.removeChild(optionsEl.firstChild);
                }
                document.body.classList.remove('correct-bg', 'incorrect-bg');
            }
            
            function selectAnswer(e) {
                clearTimeout(questionTimer);
                clearInterval(countdownInterval);

                const selectedOption = e ? e.target : null;
                // Disable all options after one is clicked
                Array.from(optionsEl.children).forEach(option => option.removeEventListener('click', selectAnswer));

                const currentQuestion = activeQuiz[currentQuestionIndex];
                const correctIndex = currentQuestion.correctAnswer;
                let isCorrect = false;

                if(selectedOption && parseInt(selectedOption.dataset.index) === correctIndex) {
                    isCorrect = true;
                }
                
                Array.from(optionsEl.children).forEach((optionNode, index) => {
                    optionNode.classList.add('disabled');
                    if (index === correctIndex) {
                        optionNode.classList.add('correct-answer');
                    }
                });

                if (isCorrect) {
                    score++;
                    if(selectedOption) selectedOption.classList.add('correct-answer');
                    document.body.classList.add('correct-bg');
                    // Add question ID to correctly answered list and save
                    if (!correctlyAnsweredIds.includes(currentQuestion.id)) {
                        correctlyAnsweredIds.push(currentQuestion.id);
                        saveProgress();
                        updateProgressBar();
                    }
                } else {
                    if (selectedOption) {
                        selectedOption.classList.add('incorrect-answer');
                    }
                    missedTopics.push(currentQuestion.topic);
                    document.body.classList.add('incorrect-bg');
                }

                setTimeout(() => {
                    currentQuestionIndex++;
                    if(currentQuestionIndex < activeQuiz.length) {
                        showQuestion();
                    } else {
                        showResults();
                    }
                }, 2500); 
            }
            
            function showResults() {
                resetState();
                quizContainer.classList.add('hidden');
                resultsContainer.classList.remove('hidden');

                const percentage = activeQuiz.length > 0 ? Math.round((score / activeQuiz.length) * 100) : 0;
                document.getElementById('quiz-percentage').textContent = `${percentage}%`;
                document.getElementById('stat-correct-count').textContent = `✔️ ${score} Acertos`;
                document.getElementById('stat-incorrect-count').textContent = `❌ ${activeQuiz.length - score} Erros`;
                
                const missedListEl = document.getElementById('missed-topics-list');
                missedListEl.innerHTML = '';
                
                if (missedTopics.some(t => t)) {
                     const uniqueMissedTopics = [...new Set(missedTopics.filter(t => t))];
                     
                     uniqueMissedTopics.forEach(topicName => {
                         const targetCard = Array.from(document.querySelectorAll('.topic-card .summary'))
                             .find(s => s.textContent.trim() === topicName)?.parentElement;

                         if (targetCard) {
                             const bubble = document.createElement('li');
                             bubble.textContent = topicName;
                             bubble.classList.add('missed-topic-bubble');

                             bubble.addEventListener('click', (e) => {
                                 e.currentTarget.classList.add('visited-topic');
                                 targetCard.scrollIntoView({ behavior: 'smooth', block: 'center' });
                                 if (!targetCard.classList.contains('is-open')) {
                                     toggleAccordion(targetCard);
                                 }
                             });
                             missedListEl.appendChild(bubble);
                         }
                     });
                } else {
                     const congrats = document.createElement('li');
                     if (activeQuiz.length > 0 && score === activeQuiz.length) {
                         congrats.textContent = "Parabéns, você acertou tudo!";
                         congrats.classList.add('text-green-600', 'font-semibold');
                     } else {
                         congrats.textContent = "Você não errou nenhuma questão com tópico associado. Bom trabalho!";
                     }
                     missedListEl.appendChild(congrats);
                }
            }

            startBtn.addEventListener('click', startQuiz);
            restartBtn.addEventListener('click', startQuiz);

            // Initial load of progress
            loadProgress();
        });
    </script>
</body>
</html>
